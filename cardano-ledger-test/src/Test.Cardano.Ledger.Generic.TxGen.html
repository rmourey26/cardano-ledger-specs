<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Generic.TxGen</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier">genAlonzoTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#Box"><span class="hs-identifier">Box</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier">applySTSByProof</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#assembleWits"><span class="hs-identifier">assembleWits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTx"><span class="hs-identifier">coreTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxBody"><span class="hs-identifier">coreTxBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier">coreTxOut</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier">genUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">Cardano.Ledger.Allegra.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">Timelock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Data</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">dataToBinaryData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">hashData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">IsValid</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">AlonzoTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxWits</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">RdmrPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Redeemers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">TxDats</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier">Cardano.Ledger.Babbage.TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier">BabbageTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier">Datum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Network</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">mkTxIxPartial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">Cardano.Ledger.Conway.TxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">ConwayDelegCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier">ConwayTxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Core</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Keys</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">KeyRole</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">coerceKeyRole</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">Cardano.Ledger.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">PrettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">ppRecord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier">Cardano.Ledger.Pretty.Babbage</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">SafeHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">hashAnnotated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.API</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">PoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">RewardAcnt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ShelleyDelegCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">StakeReference</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Withdrawals</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RewardAccounts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.Scripts</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Shelley</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">MultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">Cardano.Ledger.Shelley.TxCert</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">ShelleyTxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">DelegStakeTxCert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">RegTxCert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier">UnRegTxCert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EpochNo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EpochNo</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">TxId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Slotting.Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotNo</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">forM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">replicateM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">Control.State.Transition.Extended</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier">Assertion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">catMaybes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StrictMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">All</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Ratio</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator">(%)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word16</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.Extras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-test-1.1.2.1/doc/html/cardano-ledger-alonzo-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Alonzo.Serialisation.Generators</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-test-1.1.1.4/doc/html/cardano-ledger-babbage-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Babbage.Serialisation.Generators</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier">Test.Cardano.Ledger.Core.KeyPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier">mkWitnessVKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Fields</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#Mint"><span class="hs-identifier">Mint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Fields</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxBodyField"><span class="hs-identifier">TxBodyField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#Mint"><span class="hs-identifier">Mint</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Functions</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.GenState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier">GenEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier">GenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier">elementsT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier">frequencyT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier">genCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier">genDatumWithHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier">genFreshRegCred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier">genKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier">genNewPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier">genPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier">genPositiveVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier">genRetirementHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier">genRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier">genScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier">genValidityInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier">getCertificateMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier">getOldUtxoPercent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier">getRefInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier">getSpendInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier">getUtxoChoicesMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier">getUtxoElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier">getUtxoTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier">modifyGenStateInitialRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier">modifyGenStateInitialUtxo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier">modifyModelCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier">modifyModelIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier">modifyModelMutFee</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier">modifyModelUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ModelState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier">MUtxo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier">ModelNewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier">UtxoEntry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Updaters.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Updaters</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Updaters.html#first"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Generator.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">genNatural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Serialisation.EraIndepGenerators</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">epochFromSlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier">runShelleyBase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- ===================================================</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- Assembing lists of Fields in to (XX era)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | This uses merging semantics, it expects duplicate fields, and merges them together</span><span>
</span><span id="line-148"></span><span id="local-6989586621681313332"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#assembleWits"><span class="hs-identifier hs-type">assembleWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313332"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313332"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313332"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313332"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-149"></span><span id="assembleWits"><span class="annot"><span class="annottext">assembleWits :: forall era.
Era era =&gt;
Proof era -&gt; [WitnessesField era] -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#assembleWits"><span class="hs-identifier hs-var hs-var">assembleWits</span></a></span></span><span> </span><span id="local-6989586621681312342"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312342"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Policy
-&gt; Proof era -&gt; TxWits era -&gt; WitnessesField era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#updateWitnesses"><span class="hs-identifier hs-var">updateWitnesses</span></a></span><span> </span><span class="annot"><span class="annottext">Policy
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312342"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#initialWitnesses"><span class="hs-identifier hs-var">initialWitnesses</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312342"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621681313319"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-type">coreTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313319"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313319"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxOutField"><span class="hs-identifier hs-type">TxOutField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313319"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313319"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-152"></span><span id="coreTxOut"><span class="annot"><span class="annottext">coreTxOut :: forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var hs-var">coreTxOut</span></a></span></span><span> </span><span id="local-6989586621681312332"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312332"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; TxOut era -&gt; TxOutField era -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#updateTxOut"><span class="hs-identifier hs-var">updateTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312332"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#initialTxOut"><span class="hs-identifier hs-var">initialTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312332"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621681313313"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxBody"><span class="hs-identifier hs-type">coreTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313313"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313313"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxBodyField"><span class="hs-identifier hs-type">TxBodyField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313313"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313313"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-155"></span><span id="coreTxBody"><span class="annot"><span class="annottext">coreTxBody :: forall era.
EraTxBody era =&gt;
Proof era -&gt; [TxBodyField era] -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxBody"><span class="hs-identifier hs-var hs-var">coreTxBody</span></a></span></span><span> </span><span id="local-6989586621681312321"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312321"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
EraTxBody era =&gt;
Proof era -&gt; TxBody era -&gt; TxBodyField era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#updateTxBody"><span class="hs-identifier hs-var">updateTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312321"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#initialTxBody"><span class="hs-identifier hs-var">initialTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312321"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621681313303"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#overrideTxBody"><span class="hs-identifier hs-type">overrideTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraTxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313303"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313303"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313303"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxBodyField"><span class="hs-identifier hs-type">TxBodyField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313303"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313303"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-158"></span><span id="overrideTxBody"><span class="annot"><span class="annottext">overrideTxBody :: forall era.
EraTxBody era =&gt;
Proof era -&gt; TxBody era -&gt; [TxBodyField era] -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#overrideTxBody"><span class="hs-identifier hs-var hs-var">overrideTxBody</span></a></span></span><span> </span><span id="local-6989586621681312314"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312314"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
EraTxBody era =&gt;
Proof era -&gt; TxBody era -&gt; TxBodyField era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#updateTxBody"><span class="hs-identifier hs-var">updateTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312314"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621681313301"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTx"><span class="hs-identifier hs-type">coreTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313301"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxField"><span class="hs-identifier hs-type">TxField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313301"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313301"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-161"></span><span id="coreTx"><span class="annot"><span class="annottext">coreTx :: forall era. Proof era -&gt; [TxField era] -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTx"><span class="hs-identifier hs-var hs-var">coreTx</span></a></span></span><span> </span><span id="local-6989586621681312312"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312312"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Tx era -&gt; TxField era -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#updateTx"><span class="hs-identifier hs-var">updateTx</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312312"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#initialTx"><span class="hs-identifier hs-var">initialTx</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312312"><span class="hs-identifier hs-var">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- ====================================================================</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621681313292"><span id="local-6989586621681313294"><span id="local-6989586621681313296"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-type">lookupByKeyM</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313296"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313296"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681313296"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313294"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621681313296"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313292"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313294"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313292"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-167"></span><span id="lookupByKeyM"><span class="annot"><span class="annottext">lookupByKeyM :: forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
String -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var hs-var">lookupByKeyM</span></a></span></span><span> </span><span id="local-6989586621681312285"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681312285"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681312284"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621681312284"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681312283"><span class="annot"><span class="annottext">GenState era -&gt; Map k v
</span><a href="#local-6989586621681312283"><span class="hs-identifier hs-var">getMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621681312282"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621681312282"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map k v
</span><a href="#local-6989586621681312283"><span class="hs-identifier hs-var">getMap</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621681312284"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621681312282"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">Maybe v
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't find &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681312285"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in the test enviroment: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621681312284"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681312278"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621681312278"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621681312278"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Generate a list of specified length with randomish `ExUnit`s where the sum</span><span>
</span><span id="line-176"></span><span class="hs-comment">--   of all values produced will not exceed the maxTxExUnits.</span><span>
</span><span id="line-177"></span><span id="local-6989586621681313258"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genExUnits"><span class="hs-identifier hs-type">genExUnits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313258"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313258"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-178"></span><span id="genExUnits"><span class="annot"><span class="annottext">genExUnits :: forall era. Proof era -&gt; Int -&gt; GenRS era [ExUnits]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genExUnits"><span class="hs-identifier hs-var hs-var">genExUnits</span></a></span></span><span> </span><span id="local-6989586621681312229"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312229"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681312228"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681312228"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621681312226"><span class="annot"><span class="annottext">PParams era
gePParams :: forall era. GenEnv era -&gt; PParams era
gePParams :: PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span> </span><span id="local-6989586621681312222"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312222"><span class="hs-identifier hs-var">maxMemUnits</span></a></span></span><span> </span><span id="local-6989586621681312221"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312221"><span class="hs-identifier hs-var">maxStepUnits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; PParams era -&gt; ExUnits
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#maxTxExUnits%27"><span class="hs-identifier hs-var">maxTxExUnits'</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312229"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681312226"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621681312219"><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312219"><span class="hs-identifier hs-var">memUnits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Gen [Natural]
</span><a href="#local-6989586621681312218"><span class="hs-identifier hs-var">genSequenceSum</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312222"><span class="hs-identifier hs-var">maxMemUnits</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621681312217"><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312217"><span class="hs-identifier hs-var">stepUnits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Gen [Natural]
</span><a href="#local-6989586621681312218"><span class="hs-identifier hs-var">genSequenceSum</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312221"><span class="hs-identifier hs-var">maxStepUnits</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; ExUnits
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">ExUnits</span></a></span><span> </span><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312219"><span class="hs-identifier hs-var">memUnits</span></a></span><span> </span><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312217"><span class="hs-identifier hs-var">stepUnits</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621681312215"><span class="annot"><span class="annottext">un :: Natural
</span><a href="#local-6989586621681312215"><span class="hs-identifier hs-var hs-var">un</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681312228"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621681312214"><span class="annot"><span class="annottext">genUpTo :: Natural -&gt; (Natural, [Natural]) -&gt; Int -&gt; Gen (Natural, [Natural])
</span><a href="#local-6989586621681312214"><span class="hs-identifier hs-var hs-var">genUpTo</span></a></span></span><span> </span><span id="local-6989586621681312213"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312213"><span class="hs-identifier hs-var">maxVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621681312212"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312212"><span class="hs-identifier hs-var">totalLeft</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681312211"><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312211"><span class="hs-identifier hs-var">acc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312212"><span class="hs-identifier hs-var">totalLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312211"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>          </span><span id="local-6989586621681312210"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312210"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312212"><span class="hs-identifier hs-var">totalLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">round</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312215"><span class="hs-identifier hs-var">un</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Gen Natural
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">genNatural</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312213"><span class="hs-identifier hs-var">maxVal</span></a></span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312212"><span class="hs-identifier hs-var">totalLeft</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312210"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312210"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Natural]
</span><a href="#local-6989586621681312211"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621681312218"><span class="annot"><span class="annottext">genSequenceSum :: Natural -&gt; Gen [Natural]
</span><a href="#local-6989586621681312218"><span class="hs-identifier hs-var hs-var">genSequenceSum</span></a></span></span><span> </span><span id="local-6989586621681312205"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312205"><span class="hs-identifier hs-var">maxVal</span></a></span></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312205"><span class="hs-identifier hs-var">maxVal</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681312228"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.foldlM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; (Natural, [Natural]) -&gt; Int -&gt; Gen (Natural, [Natural])
</span><a href="#local-6989586621681312214"><span class="hs-identifier hs-var">genUpTo</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312205"><span class="hs-identifier hs-var">maxVal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681312205"><span class="hs-identifier hs-var">maxVal</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681312228"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-type">lookupScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681313218"><span class="annot"><a href="#local-6989586621681313218"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313218"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313218"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313218"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span id="lookupScript"><span class="annot"><span class="annottext">lookupScript :: forall era.
ScriptHash (EraCrypto era)
-&gt; Maybe Tag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var hs-var">lookupScript</span></a></span></span><span> </span><span id="local-6989586621681312176"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681312176"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span> </span><span id="local-6989586621681312175"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312175"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621681312174"><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621681312174"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681312176"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621681312174"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681312172"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312172"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312172"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681312171"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681312171"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312175"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
String -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;plutusScript&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681312176"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681312171"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map (ScriptHash (EraCrypto era), Tag) (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- =====================================</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621681313198"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-type">genGenericScriptWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313198"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313198"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313198"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313198"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313198"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313198"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-217"></span><span id="genGenericScriptWitness"><span class="annot"><span class="annottext">genGenericScriptWitness :: forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Script era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-var hs-var">genGenericScriptWitness</span></a></span></span><span> </span><span id="local-6989586621681312167"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681312166"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span id="local-6989586621681312165"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; MultiSig era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">TimelockScript</span></a></span><span> </span><span id="local-6989586621681312136"><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621681312136"><span class="hs-identifier hs-var">timelock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621681312136"><span class="hs-identifier hs-var">timelock</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Plutus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">TimelockScript</span></a></span><span> </span><span id="local-6989586621681312123"><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621681312123"><span class="hs-identifier hs-var">timelock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621681312123"><span class="hs-identifier hs-var">timelock</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Plutus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312165"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">TimelockScript</span></a></span><span> </span><span id="local-6989586621681312112"><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621681312112"><span class="hs-identifier hs-var">timelock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312167"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312166"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621681312112"><span class="hs-identifier hs-var">timelock</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Plutus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Generate a TxWits producing function. We handle TxWits come from Keys and Scripts</span><span>
</span><span id="line-233"></span><span class="hs-comment">--   Because scripts vary be Era, we need some Era specific code here: genGenericScriptWitness</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-type">mkWitVKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681313170"><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621681313169"><span class="annot"><a href="#local-6989586621681313169"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313169"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span id="mkWitVKey"><span class="annot"><span class="annottext">mkWitVKey :: forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var hs-var">mkWitVKey</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681312067"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312067"><span class="hs-identifier hs-var">_mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span id="local-6989586621681312065"><span class="annot"><span class="annottext">KeyHash kr (EraCrypto era)
</span><a href="#local-6989586621681312065"><span class="hs-identifier hs-var">keyHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621681312064"><span class="annot"><span class="annottext">KeyPair 'Witness (EraCrypto era)
</span><a href="#local-6989586621681312064"><span class="hs-identifier hs-var">keyPair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
String -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;credential&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash kr (EraCrypto era)
</span><a href="#local-6989586621681312065"><span class="hs-identifier hs-var">keyHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map
     (KeyHash 'Witness (EraCrypto era))
     (KeyPair 'Witness (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681312062"><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681312062"><span class="hs-identifier hs-var">bodyHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
[WitVKey 'Witness (EraCrypto era)] -&gt; WitnessesField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#AddrWits%27"><span class="hs-identifier hs-var">AddrWits'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall c (kr :: KeyRole).
(Crypto c, DSignable c (Hash (HASH c) EraIndependentTxBody)) =&gt;
SafeHash c EraIndependentTxBody
-&gt; KeyPair kr c -&gt; WitVKey 'Witness c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/l/testlib/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">mkWitnessVKey</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681312062"><span class="hs-identifier hs-var">bodyHash</span></a></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness (EraCrypto era)
</span><a href="#local-6989586621681312064"><span class="hs-identifier hs-var">keyPair</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span id="local-6989586621681312060"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312060"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681312059"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312059"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621681312057"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681312057"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="annottext">forall era.
ScriptHash (EraCrypto era)
-&gt; Maybe Tag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var">lookupScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681313170"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681312057"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312059"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Impossible: Cannot find script with hash &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681312057"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681312056"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312056"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681312055"><span class="annot"><span class="annottext">scriptWit :: WitnessesField era
</span><a href="#local-6989586621681312055"><span class="hs-identifier hs-var hs-var">scriptWit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraScript era =&gt; [Script era] -&gt; WitnessesField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#ScriptWits%27"><span class="hs-identifier hs-var">ScriptWits'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312056"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621681312053"><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; [WitnessesField era]
</span><a href="#local-6989586621681312053"><span class="hs-identifier hs-var">otherWit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Script era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-var">genGenericScriptWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312060"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312059"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681312056"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681312052"><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681312052"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WitnessesField era
</span><a href="#local-6989586621681312055"><span class="hs-identifier hs-var">scriptWit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; [WitnessesField era]
</span><a href="#local-6989586621681312053"><span class="hs-identifier hs-var">otherWit</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681312052"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- Generating TxWits, here we are not adding anything to the GenState</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- only looking up things already added, and assembling the right pieces to</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- make TxWits.</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Used in Shelley Eras</span><span>
</span><span id="line-259"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-type">mkMultiSigWit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681313189"><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">Shelley.MultiSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313189"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span id="mkMultiSigWit"><span class="annot"><span class="annottext">mkMultiSigWit :: forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; MultiSig era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var hs-var">mkMultiSigWit</span></a></span></span><span> </span><span id="local-6989586621681312012"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312012"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681312011"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312011"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">Shelley.RequireSignature</span></a></span><span> </span><span id="local-6989586621681312009"><span class="annot"><span class="annottext">KeyHash 'Witness (EraCrypto era)
</span><a href="#local-6989586621681312009"><span class="hs-identifier hs-var">keyHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312012"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312011"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness (EraCrypto era)
</span><a href="#local-6989586621681312009"><span class="hs-identifier hs-var">keyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span id="local-6989586621681312008"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312008"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681312007"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312007"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">Shelley.RequireAllOf</span></a></span><span> </span><span id="local-6989586621681312005"><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681312005"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; MultiSig era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312008"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312007"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681312005"><span class="hs-identifier hs-var">timelocks</span></a></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span id="local-6989586621681312002"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312002"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681312001"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312001"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">Shelley.RequireAnyOf</span></a></span><span> </span><span id="local-6989586621681311999"><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311999"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.null</span></a></span><span> </span><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311999"><span class="hs-identifier hs-var">timelocks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; MultiSig era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681312002"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681312001"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311999"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span id="local-6989586621681311994"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311994"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681311993"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311993"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">Shelley.RequireMOf</span></a></span><span> </span><span id="local-6989586621681311991"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311991"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681311990"><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311990"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621681311989"><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311989"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311991"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><span class="hs-identifier hs-var">shuffle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311990"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; MultiSig era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311994"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311993"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621681311989"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Timeock scripts are used in Mary and subsequent Eras.</span><span>
</span><span id="line-276"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-type">mkTimelockWit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681313185"><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313185"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span id="mkTimelockWit"><span class="annot"><span class="annottext">mkTimelockWit :: forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var hs-var">mkTimelockWit</span></a></span></span><span> </span><span id="local-6989586621681311944"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311944"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681311943"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311943"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">RequireSignature</span></a></span><span> </span><span id="local-6989586621681311941"><span class="annot"><span class="annottext">KeyHash 'Witness (EraCrypto era)
</span><a href="#local-6989586621681311941"><span class="hs-identifier hs-var">keyHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311944"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311943"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness (EraCrypto era)
</span><a href="#local-6989586621681311941"><span class="hs-identifier hs-var">keyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">RequireAllOf</span></a></span><span> </span><span id="local-6989586621681311939"><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311939"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311944"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311943"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311939"><span class="hs-identifier hs-var">timelocks</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">RequireAnyOf</span></a></span><span> </span><span id="local-6989586621681311937"><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311937"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.null</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311937"><span class="hs-identifier hs-var">timelocks</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311944"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311943"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311937"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">RequireMOf</span></a></span><span> </span><span id="local-6989586621681311935"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311935"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681311934"><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311934"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>      </span><span id="local-6989586621681311933"><span class="annot"><span class="annottext">[Timelock era]
</span><a href="#local-6989586621681311933"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311935"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><span class="hs-identifier hs-var">shuffle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
</span><a href="#local-6989586621681311934"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Timelock era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311944"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311943"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Timelock era]
</span><a href="#local-6989586621681311933"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">RequireTimeStart</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">RequireTimeExpire</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Same as `genCredKeyWit`, but for `TxOuts`</span><span>
</span><span id="line-297"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-type">genTxOutKeyWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681313100"><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313100"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span id="genTxOutKeyWitness"><span class="annot"><span class="annottext">genTxOutKeyWitness :: forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; TxOut era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var hs-var">genTxOutKeyWitness</span></a></span></span><span> </span><span id="local-6989586621681311903"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311903"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681311902"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311902"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span id="local-6989586621681311901"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311901"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311901"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
Lens' (TxOut era) (Addr (EraCrypto era))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">addrTxOutL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">AddrBootstrap</span></a></span><span> </span><span id="local-6989586621681311898"><span class="annot"><span class="annottext">BootstrapAddress (EraCrypto era)
</span><a href="#local-6989586621681311898"><span class="hs-identifier hs-var">baddr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't authorize bootstrap address: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress (EraCrypto era)
</span><a href="#local-6989586621681311898"><span class="hs-identifier hs-var">baddr</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681311896"><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621681311896"><span class="hs-identifier hs-var">payCred</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; TxOut era -&gt; StrictMaybe (Script era)
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#getTxOutRefScript"><span class="hs-identifier hs-var">getTxOutRefScript</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311901"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">StrictMaybe (Script era)
</span><span class="hs-identifier hs-var">SNothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311903"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311902"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621681311896"><span class="hs-identifier hs-var">payCred</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span id="local-6989586621681311891"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681311891"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>          </span><span id="local-6989586621681311890"><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; [WitnessesField era]
</span><a href="#local-6989586621681311890"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311903"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311902"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621681311896"><span class="hs-identifier hs-var">payCred</span></a></span><span>
</span><span id="line-313"></span><span>          </span><span id="local-6989586621681311889"><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; [WitnessesField era]
</span><a href="#local-6989586621681311889"><span class="hs-identifier hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Script era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-var">genGenericScriptWitness</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681311891"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-314"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681311887"><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681311887"><span class="hs-identifier hs-var">safehash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; [WitnessesField era]
</span><a href="#local-6989586621681311890"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681311887"><span class="hs-identifier hs-var">safehash</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
-&gt; [WitnessesField era]
</span><a href="#local-6989586621681311889"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681311887"><span class="hs-identifier hs-var">safehash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCredKeyWit"><span class="hs-identifier hs-type">genCredKeyWit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681311885"><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621681311884"><span class="annot"><a href="#local-6989586621681311884"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311884"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311885"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span id="genCredKeyWit"><span class="annot"><span class="annottext">genCredKeyWit :: forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCredKeyWit"><span class="hs-identifier hs-var hs-var">genCredKeyWit</span></a></span></span><span> </span><span id="local-6989586621681311881"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311881"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621681311880"><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311880"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span id="local-6989586621681311879"><span class="annot"><span class="annottext">Credential k (EraCrypto era)
</span><a href="#local-6989586621681311879"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311881"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tag
</span><a href="#local-6989586621681311880"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Credential k (EraCrypto era)
</span><a href="#local-6989586621681311879"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621681313080"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#makeDatumWitness"><span class="hs-identifier hs-type">makeDatumWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313080"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313080"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313080"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313080"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-326"></span><span id="makeDatumWitness"><span class="annot"><span class="annottext">makeDatumWitness :: forall era.
Proof era -&gt; TxOut era -&gt; GenRS era [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#makeDatumWitness"><span class="hs-identifier hs-var hs-var">makeDatumWitness</span></a></span></span><span> </span><span id="local-6989586621681311873"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311873"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681311872"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311872"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311873"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311872"><span class="hs-identifier hs-var">txout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (BabbageEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (BabbageEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621681311859"><span class="annot"><span class="annottext">DataHash (EraCrypto (BabbageEra c))
</span><a href="#local-6989586621681311859"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script (BabbageEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {era}.
Era era =&gt;
StrictMaybe (DataHash (EraCrypto era))
-&gt; RWST (GenEnv era) () (GenState era) Gen [WitnessesField era]
</span><a href="#local-6989586621681311858"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">DataHash (EraCrypto (BabbageEra c))
</span><a href="#local-6989586621681311859"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (BabbageEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (BabbageEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryData (BabbageEra c)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script (BabbageEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (BabbageEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (BabbageEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Datum (BabbageEra c)
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">NoDatum</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script (BabbageEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (ConwayEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (ConwayEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621681311828"><span class="annot"><span class="annottext">DataHash (EraCrypto (ConwayEra c))
</span><a href="#local-6989586621681311828"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script (ConwayEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {era}.
Era era =&gt;
StrictMaybe (DataHash (EraCrypto era))
-&gt; RWST (GenEnv era) () (GenState era) Gen [WitnessesField era]
</span><a href="#local-6989586621681311858"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">DataHash (EraCrypto (ConwayEra c))
</span><a href="#local-6989586621681311828"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (ConwayEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (ConwayEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryData (ConwayEra c)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script (ConwayEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-babbage-1.4.3.0/doc/html/cardano-ledger-babbage/src"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (ConwayEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (ConwayEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Datum (ConwayEra c)
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">NoDatum</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script (ConwayEra c))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">AlonzoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto (AlonzoEra c))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value (AlonzoEra c)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681311799"><span class="annot"><span class="annottext">StrictMaybe (DataHash (EraCrypto (AlonzoEra c)))
</span><a href="#local-6989586621681311799"><span class="hs-identifier hs-var">mDatum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {era}.
Era era =&gt;
StrictMaybe (DataHash (EraCrypto era))
-&gt; RWST (GenEnv era) () (GenState era) Gen [WitnessesField era]
</span><a href="#local-6989586621681311858"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (DataHash (EraCrypto (AlonzoEra c)))
</span><a href="#local-6989586621681311799"><span class="hs-identifier hs-var">mDatum</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="annottext">(Proof era, TxOut era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- No other era has data witnesses</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621681311858"><span class="annot"><span class="annottext">mkDatumWit :: StrictMaybe (DataHash (EraCrypto era))
-&gt; RWST (GenEnv era) () (GenState era) Gen [WitnessesField era]
</span><a href="#local-6989586621681311858"><span class="hs-identifier hs-var hs-var">mkDatumWit</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (DataHash (EraCrypto era))
</span><span class="hs-identifier hs-var">SNothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="#local-6989586621681311858"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span id="local-6989586621681311784"><span class="annot"><span class="annottext">DataHash (EraCrypto era)
</span><a href="#local-6989586621681311784"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621681311783"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681311783"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
String -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">DataHash (EraCrypto era)
</span><a href="#local-6989586621681311784"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Era era =&gt; [Data era] -&gt; WitnessesField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#DataWits%27"><span class="hs-identifier hs-var">DataWits'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681311783"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Does the current Credential point to a PlutusScript? If so return its IsValid and Hash</span><span>
</span><span id="line-342"></span><span id="local-6989586621681313050"><span id="local-6989586621681313051"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupPlutusScript"><span class="hs-identifier hs-type">lookupPlutusScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313051"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313050"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-346"></span><span id="lookupPlutusScript"><span class="annot"><span class="annottext">lookupPlutusScript :: forall (k :: KeyRole) era.
Credential k (EraCrypto era)
-&gt; Tag -&gt; GenRS era (Maybe (IsValid, ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupPlutusScript"><span class="hs-identifier hs-var hs-var">lookupPlutusScript</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash k (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-347"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupPlutusScript"><span class="hs-identifier hs-var">lookupPlutusScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621681311768"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311768"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681311767"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681311767"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311768"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681311767"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map (ScriptHash (EraCrypto era), Tag) (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="annottext">Maybe (IsValid, Script era)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311765"><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621681311765"><span class="hs-identifier hs-var">isValid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Script era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621681311765"><span class="hs-identifier hs-var">isValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311768"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | Make RdmrWits WitnessesField only if the Credential is for a Plutus Script</span><span>
</span><span id="line-353"></span><span class="hs-comment">--  And it is in the spending inputs, not the reference inputs</span><span>
</span><span id="line-354"></span><span id="local-6989586621681313040"><span id="local-6989586621681313041"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-type">redeemerWitnessMaker</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313041"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313041"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313041"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313040"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313041"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313041"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313041"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-359"></span><span id="redeemerWitnessMaker"><span class="annot"><span class="annottext">redeemerWitnessMaker :: forall era (k :: KeyRole).
Era era =&gt;
Tag
-&gt; [Maybe (GenRS era (Data era), Credential k (EraCrypto era))]
-&gt; GenRS era (IsValid, [ExUnits -&gt; [WitnessesField era]])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var hs-var">redeemerWitnessMaker</span></a></span></span><span> </span><span id="local-6989586621681311742"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681311742"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621681311741"><span class="annot"><span class="annottext">[Maybe (GenRS era (Data era), Credential k (EraCrypto era))]
</span><a href="#local-6989586621681311741"><span class="hs-identifier hs-var">listWithCred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311740"><span class="annot"><span class="annottext">creds :: [(Word64, GenRS era (Data era), Credential k (EraCrypto era))]
</span><a href="#local-6989586621681311740"><span class="hs-identifier hs-var hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311739"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenRS era (Data era)
</span><a href="#local-6989586621681311738"><span class="hs-identifier hs-var">genDat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential k (EraCrypto era)
</span><a href="#local-6989586621681311737"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311739"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311739"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311736"><span class="annot"><span class="annottext">Maybe (GenRS era (Data era), Credential k (EraCrypto era))
</span><a href="#local-6989586621681311736"><span class="hs-identifier hs-var">mCred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Maybe (GenRS era (Data era), Credential k (EraCrypto era))]
</span><a href="#local-6989586621681311741"><span class="hs-identifier hs-var">listWithCred</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311738"><span class="annot"><span class="annottext">GenRS era (Data era)
</span><a href="#local-6989586621681311738"><span class="hs-identifier hs-var">genDat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311737"><span class="annot"><span class="annottext">Credential k (EraCrypto era)
</span><a href="#local-6989586621681311737"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe (GenRS era (Data era), Credential k (EraCrypto era))
</span><a href="#local-6989586621681311736"><span class="hs-identifier hs-var">mCred</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><a href="#local-6989586621681311735"><span class="hs-identifier hs-type">allValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span id="local-6989586621681311735"><span class="annot"><span class="annottext">allValid :: [IsValid] -&gt; IsValid
</span><a href="#local-6989586621681311735"><span class="hs-identifier hs-var hs-var">allValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IsValid
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">getAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621681311731"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681311731"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681311731"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">[IsValid] -&gt; IsValid
</span><a href="#local-6989586621681311735"><span class="hs-identifier hs-var">allValid</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, GenRS era (Data era), Credential k (EraCrypto era))]
</span><a href="#local-6989586621681311740"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681311728"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311728"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311727"><span class="annot"><span class="annottext">GenRS era (Data era)
</span><a href="#local-6989586621681311727"><span class="hs-identifier hs-var">genDat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311726"><span class="annot"><span class="annottext">Credential k (EraCrypto era)
</span><a href="#local-6989586621681311726"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>          </span><span class="annot"><span class="annottext">forall (k :: KeyRole) era.
Credential k (EraCrypto era)
-&gt; Tag -&gt; GenRS era (Maybe (IsValid, ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupPlutusScript"><span class="hs-identifier hs-var">lookupPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Credential k (EraCrypto era)
</span><a href="#local-6989586621681311726"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681311742"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-370"></span><span>            </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash (EraCrypto era))
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-371"></span><span>            </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311725"><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621681311725"><span class="hs-identifier hs-var">isValid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>              </span><span id="local-6989586621681311724"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681311724"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (Data era)
</span><a href="#local-6989586621681311727"><span class="hs-identifier hs-var">genDat</span></a></span><span>
</span><span id="line-373"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311723"><span class="annot"><span class="annottext">rPtr :: RdmrPtr
</span><a href="#local-6989586621681311723"><span class="hs-identifier hs-var hs-var">rPtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Word64 -&gt; RdmrPtr
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">RdmrPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621681311742"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311728"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-374"></span><span>                  </span><span id="local-6989586621681311721"><span class="annot"><span class="annottext">mkWit3 :: ExUnits -&gt; [WitnessesField era]
</span><a href="#local-6989586621681311721"><span class="hs-identifier hs-var hs-var">mkWit3</span></a></span></span><span> </span><span id="local-6989586621681311720"><span class="annot"><span class="annottext">ExUnits
</span><a href="#local-6989586621681311720"><span class="hs-identifier hs-var">exUnits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Redeemers era -&gt; WitnessesField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#RdmrWits"><span class="hs-identifier hs-var">RdmrWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits) -&gt; Redeemers era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">RdmrPtr
</span><a href="#local-6989586621681311723"><span class="hs-identifier hs-var">rPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681311724"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExUnits
</span><a href="#local-6989586621681311720"><span class="hs-identifier hs-var">exUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span>              </span><span class="hs-comment">-- we should not add this if the tx turns out to be in the reference inputs.</span><span>
</span><span id="line-376"></span><span>              </span><span class="hs-comment">-- we accomplish this by not calling this function on referenceInputs</span><span>
</span><span id="line-377"></span><span>              </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621681311725"><span class="hs-identifier hs-var">isValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExUnits -&gt; [WitnessesField era]
</span><a href="#local-6989586621681311721"><span class="hs-identifier hs-var">mkWit3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- Now we start actual generators that create things and enter them into</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- the GenState, and sometimes into the Model.</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Collaterals can't have scripts, this is where this generator is needed.</span><span>
</span><span id="line-384"></span><span class="hs-comment">--   As we generate this we add to the gsKeys field of the GenState.</span><span>
</span><span id="line-385"></span><span id="local-6989586621681313014"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genNoScriptRecipient"><span class="hs-identifier hs-type">genNoScriptRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313014"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313014"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313014"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-386"></span><span id="genNoScriptRecipient"><span class="annot"><span class="annottext">genNoScriptRecipient :: forall era. Reflect era =&gt; GenRS era (Addr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genNoScriptRecipient"><span class="hs-identifier hs-var hs-var">genNoScriptRecipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>  </span><span id="local-6989586621681311704"><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681311704"><span class="hs-identifier hs-var">paymentCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621681311703"><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><a href="#local-6989586621681311703"><span class="hs-identifier hs-var">stakeCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall c. StakeCredential c -&gt; StakeReference c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">StakeRefBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
GenRS era (KeyHash kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c.
Network -&gt; PaymentCredential c -&gt; StakeReference c -&gt; Addr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Testnet</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681311704"><span class="hs-identifier hs-var">paymentCred</span></a></span><span> </span><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><a href="#local-6989586621681311703"><span class="hs-identifier hs-var">stakeCred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Sometimes generates new Credentials, and some times reuses old ones</span><span>
</span><span id="line-392"></span><span id="local-6989586621681311700"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipient"><span class="hs-identifier hs-type">genRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311700"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311700"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311700"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-393"></span><span id="genRecipient"><span class="annot"><span class="annottext">genRecipient :: forall era. Reflect era =&gt; GenRS era (Addr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipient"><span class="hs-identifier hs-var hs-var">genRecipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621681311689"><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621681311689"><span class="hs-identifier hs-var">paymentCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Tag -&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621681311688"><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311688"><span class="hs-identifier hs-var">stakeCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Tag -&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c.
Network -&gt; PaymentCredential c -&gt; StakeReference c -&gt; Addr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Testnet</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentCredential (EraCrypto era)
</span><a href="#local-6989586621681311689"><span class="hs-identifier hs-var">paymentCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. StakeCredential c -&gt; StakeReference c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">StakeRefBase</span></a></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311688"><span class="hs-identifier hs-var">stakeCred</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span id="local-6989586621681313002"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-type">genDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313002"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313002"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681313002"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-399"></span><span id="genDatum"><span class="annot"><span class="annottext">genDatum :: forall era. Era era =&gt; GenRS era (Data era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-var hs-var">genDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
GenRS era (DataHash (EraCrypto era), Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Generate a Babbage Datum witness to use as a redeemer for a Plutus Script.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   TxWits can be a ScriptHash, or an inline Datum</span><span>
</span><span id="line-403"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-type">genBabbageDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312999"><span class="annot"><a href="#local-6989586621681312999"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312999"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312999"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312999"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span id="genBabbageDatum"><span class="annot"><span class="annottext">genBabbageDatum :: forall era. Era era =&gt; GenRS era (Datum era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-var hs-var">genBabbageDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. DataHash (EraCrypto era) -&gt; Datum era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">DatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
GenRS era (DataHash (EraCrypto era), Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. BinaryData era -&gt; Datum era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Data era -&gt; BinaryData era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">dataToBinaryData</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
GenRS era (DataHash (EraCrypto era), Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span id="local-6989586621681312991"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-type">genRefScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312991"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312991"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312991"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312991"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-411"></span><span id="genRefScript"><span class="annot"><span class="annottext">genRefScript :: forall era.
Reflect era =&gt;
Proof era -&gt; GenRS era (StrictMaybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-var hs-var">genRefScript</span></a></span></span><span> </span><span id="local-6989586621681311659"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311659"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621681311658"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311658"><span class="hs-identifier hs-var">scripthash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Tag -&gt; GenRS era (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311659"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621681311657"><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311657"><span class="hs-identifier hs-var">mscript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
ScriptHash (EraCrypto era)
-&gt; Maybe Tag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var">lookupScript</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311658"><span class="hs-identifier hs-var">scripthash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311657"><span class="hs-identifier hs-var">mscript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681311656"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681311656"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621681311656"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | Gen the Datum and RefScript fields of a TxOut by Analyzing the payment credential's script</span><span>
</span><span id="line-419"></span><span id="local-6989586621681312988"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDataHashField"><span class="hs-identifier hs-type">genDataHashField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312988"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312988"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312988"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312988"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxOutField"><span class="hs-identifier hs-type">TxOutField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312988"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-420"></span><span id="genDataHashField"><span class="annot"><span class="annottext">genDataHashField :: forall era.
Reflect era =&gt;
Proof era -&gt; Maybe (Script era) -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDataHashField"><span class="hs-identifier hs-var hs-var">genDataHashField</span></a></span></span><span> </span><span id="local-6989586621681311647"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311647"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681311646"><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311646"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311647"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311646"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Plutus
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-424"></span><span>        </span><span id="local-6989586621681311633"><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621681311633"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; GenRS era (Datum era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-var">genBabbageDatum</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span id="local-6989586621681311632"><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript (ConwayEra c))
</span><a href="#local-6989586621681311632"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; GenRS era (StrictMaybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-var">genRefScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311647"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Datum era -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#FDatum"><span class="hs-identifier hs-var">FDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621681311633"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe (Script era) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#RefScript"><span class="hs-identifier hs-var">RefScript</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript (ConwayEra c))
</span><a href="#local-6989586621681311632"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311646"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Plutus
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>        </span><span id="local-6989586621681311617"><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621681311617"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; GenRS era (Datum era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-var">genBabbageDatum</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span id="local-6989586621681311616"><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript (BabbageEra c))
</span><a href="#local-6989586621681311616"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; GenRS era (StrictMaybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-var">genRefScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311647"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Datum era -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#FDatum"><span class="hs-identifier hs-var">FDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621681311617"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe (Script era) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#RefScript"><span class="hs-identifier hs-var">RefScript</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript (BabbageEra c))
</span><a href="#local-6989586621681311616"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311646"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-435"></span><span>      </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">Plutus
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681311606"><span class="annot"><span class="annottext">DataHash c
</span><a href="#local-6989586621681311606"><span class="hs-identifier hs-var">datahash</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311605"><span class="annot"><span class="annottext">Data (AlonzoEra c)
</span><a href="#local-6989586621681311605"><span class="hs-identifier hs-var">_data</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
GenRS era (DataHash (EraCrypto era), Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era.
StrictMaybe (DataHash (EraCrypto era)) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#DHash"><span class="hs-identifier hs-var">DHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">DataHash c
</span><a href="#local-6989586621681311606"><span class="hs-identifier hs-var">datahash</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- No other Era has any datum in the TxOut</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | Generate the list of TxOutField that constitute a TxOut</span><span>
</span><span id="line-442"></span><span id="local-6989586621681312982"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-type">genTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312982"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312982"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312982"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312982"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#TxOutField"><span class="hs-identifier hs-type">TxOutField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312982"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-443"></span><span id="genTxOut"><span class="annot"><span class="annottext">genTxOut :: forall era.
Reflect era =&gt;
Proof era -&gt; Value era -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var hs-var">genTxOut</span></a></span></span><span> </span><span id="local-6989586621681311587"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311587"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681311586"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681311586"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>  </span><span id="local-6989586621681311585"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311585"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (Addr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipient"><span class="hs-identifier hs-var">genRecipient</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621681311584"><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681311584"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BootstrapAddress encountered&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c. Addr c -&gt; Maybe (Credential 'Payment c)
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#paymentCredAddr"><span class="hs-identifier hs-var">paymentCredAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311585"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621681311581"><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681311581"><span class="hs-identifier hs-var">dataHashFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681311584"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Payment (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621681311580"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311580"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>        </span><span id="local-6989586621681311579"><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311579"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
ScriptHash (EraCrypto era)
-&gt; Maybe Tag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var">lookupScript</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311580"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>        </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Maybe (Script era) -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDataHashField"><span class="hs-identifier hs-var">genDataHashField</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311587"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621681311579"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Addr (EraCrypto era) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311585"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Value era -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Amount"><span class="hs-identifier hs-var">Amount</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681311586"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681311581"><span class="hs-identifier hs-var">dataHashFields</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">-- | Generate a TxIn whose TxIx will never clash with an Input created from a TxOut</span><span>
</span><span id="line-457"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxIn"><span class="hs-identifier hs-type">genTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312977"><span class="annot"><a href="#local-6989586621681312977"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312977"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312977"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312977"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span id="genTxIn"><span class="annot"><span class="annottext">genTxIn :: forall era.
Reflect era =&gt;
Proof era -&gt; Int -&gt; Gen (TxIn (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxIn"><span class="hs-identifier hs-var hs-var">genTxIn</span></a></span></span><span> </span><span id="local-6989586621681311554"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681311554"><span class="hs-identifier hs-var">_proof</span></a></span></span><span> </span><span id="local-6989586621681311553"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311553"><span class="hs-identifier hs-var">numChoices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621681311552"><span class="annot"><span class="annottext">TxId (EraCrypto era)
</span><a href="#local-6989586621681311552"><span class="hs-identifier hs-var">txId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Gen a -&gt; Gen a
</span><span class="hs-identifier hs-var">resize</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-comment">-- The TxIx for Inputs created from outputs of a TxBody, will only range from (1..numChoices)</span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-comment">-- TxIx for these arbitrary Inputs range from (n+1..n+100). This makes the TxIx ranges</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-comment">-- incommensurate.</span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621681311549"><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621681311549"><span class="hs-identifier hs-var">txIx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Integer -&gt; TxIx
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">mkTxIxPartial</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311553"><span class="hs-identifier hs-var">numChoices</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311553"><span class="hs-identifier hs-var">numChoices</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. TxId c -&gt; TxIx -&gt; TxIn c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">TxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxId (EraCrypto era)
</span><a href="#local-6989586621681311552"><span class="hs-identifier hs-var">txId</span></a></span><span> </span><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621681311549"><span class="hs-identifier hs-var">txIx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Generate a non-empty List of fresh TxIn. By fresh we mean TxIn's that</span><span>
</span><span id="line-467"></span><span class="hs-comment">--   we have not generated previously. We use the current InitialUtxo to test this.</span><span>
</span><span id="line-468"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-type">genFreshTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312965"><span class="annot"><a href="#local-6989586621681312965"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312965"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312965"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312965"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-469"></span><span id="genFreshTxIn"><span class="annot"><span class="annottext">genFreshTxIn :: forall era. Reflect era =&gt; Int -&gt; GenRS era [TxIn (EraCrypto era)]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var hs-var">genFreshTxIn</span></a></span></span><span> </span><span id="local-6989586621681311511"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311511"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311511"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not generate a fresh TxIn after many tries.&quot;</span></span><span>
</span><span id="line-470"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var">genFreshTxIn</span></a></span><span> </span><span id="local-6989586621681311509"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311509"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621681311508"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311508"><span class="hs-identifier hs-var">entriesInUse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-comment">-- Max number of choices. So the UTxO will never be larger than this</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621681311506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311506"><span class="hs-identifier hs-var">numChoicesMax</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier hs-var">getUtxoChoicesMax</span></a></span><span>
</span><span id="line-474"></span><span>  </span><span id="local-6989586621681311505"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311505"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311506"><span class="hs-identifier hs-var">numChoicesMax</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621681311504"><span class="annot"><span class="annottext">[TxIn (EraCrypto era)]
</span><a href="#local-6989586621681311504"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">vectorOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311505"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Int -&gt; Gen (TxIn (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxIn"><span class="hs-identifier hs-var">genTxIn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681312965"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311506"><span class="hs-identifier hs-var">numChoicesMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311508"><span class="hs-identifier hs-var">entriesInUse</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxIn (EraCrypto era)]
</span><a href="#local-6989586621681311504"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Int -&gt; GenRS era [TxIn (EraCrypto era)]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var">genFreshTxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311509"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621681311501"><span class="annot"><span class="annottext">[TxIn (EraCrypto era)]
</span><a href="#local-6989586621681311501"><span class="hs-identifier hs-var">freshTxIns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311506"><span class="hs-identifier hs-var">numChoicesMax</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn (EraCrypto era)]
</span><a href="#local-6989586621681311501"><span class="hs-identifier hs-var">freshTxIns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- ====================================================================</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- Generating UTxO and associated Inputs (Set (TxIn era))</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- | Generate a somewhat arbitrary MUtxo.  Occasionally add a bit of</span><span>
</span><span id="line-484"></span><span class="hs-comment">--   the MUtxo in the Model to the one generated.  This way the Tx we generate may</span><span>
</span><span id="line-485"></span><span class="hs-comment">--   spend some of the old UTxo. The result has at most 1 entry from the</span><span>
</span><span id="line-486"></span><span class="hs-comment">--   old MUtxo, and If it has only one entry, that entry is not from the old MUtxo</span><span>
</span><span id="line-487"></span><span id="local-6989586621681312957"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier hs-type">genUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312957"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312957"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312957"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312957"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-488"></span><span id="genUTxO"><span class="annot"><span class="annottext">genUTxO :: forall era.
Reflect era =&gt;
GenRS era (MUtxo era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier hs-var hs-var">genUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-489"></span><span>  </span><span id="local-6989586621681311471"><span class="annot"><span class="annottext">[TxIn (EraCrypto era)]
</span><a href="#local-6989586621681311471"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Int -&gt; GenRS era [TxIn (EraCrypto era)]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var">genFreshTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-490"></span><span>  </span><span id="local-6989586621681311470"><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311470"><span class="hs-identifier hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681311468"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311468"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311468"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxOut era)
</span><a href="#local-6989586621681311467"><span class="hs-identifier hs-var">genOut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxIn (EraCrypto era)]
</span><a href="#local-6989586621681311471"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>  </span><span id="local-6989586621681311466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311466"><span class="hs-identifier hs-var">percent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier hs-var">getOldUtxoPercent</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-comment">-- Choose a pair from the oldUTxO</span><span>
</span><span id="line-493"></span><span>  </span><span id="local-6989586621681311465"><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621681311465"><span class="hs-identifier hs-var">maybepair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311466"><span class="hs-identifier hs-var">percent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS era (Maybe (TxIn (EraCrypto era), TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier hs-var">getUtxoElem</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311466"><span class="hs-identifier hs-var">percent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Maybe a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681311463"><span class="hs-identifier hs-var">maybeCons</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621681311465"><span class="hs-identifier hs-var">maybepair</span></a></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311470"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621681311465"><span class="hs-identifier hs-var">maybepair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-comment">-- Note: Never add an old pair unless there are more than 1 new pairs</span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621681311463"><span class="annot"><span class="annottext">maybeCons :: Maybe a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621681311463"><span class="hs-identifier hs-var hs-var">maybeCons</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681311459"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311459"><span class="hs-identifier hs-var">pair</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681311458"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311458"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311458"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311459"><span class="hs-identifier hs-var">pair</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311458"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="#local-6989586621681311463"><span class="hs-identifier hs-var">maybeCons</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681311455"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311455"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311455"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-499"></span><span>    </span><span id="local-6989586621681311467"><span class="annot"><span class="annottext">genOut :: RWST (GenEnv era) () (GenState era) Gen (TxOut era)
</span><a href="#local-6989586621681311467"><span class="hs-identifier hs-var hs-var">genOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-500"></span><span>      </span><span id="local-6989586621681311441"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681311441"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-501"></span><span>      </span><span id="local-6989586621681311440"><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681311440"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Value era -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681311441"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681311440"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- | Generate both the spending and reference inputs and a key from the spending</span><span>
</span><span id="line-505"></span><span class="hs-comment">--   inputs we can use to pay the fee. That key is never from the oldUTxO</span><span>
</span><span id="line-506"></span><span id="local-6989586621681312943"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genSpendReferenceInputs"><span class="hs-identifier hs-type">genSpendReferenceInputs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-comment">-- The fee key, used to pay the fee.</span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312943"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-special">)</span></span><span>
</span><span id="line-515"></span><span id="genSpendReferenceInputs"><span class="annot"><span class="annottext">genSpendReferenceInputs :: forall era.
Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; GenRS
     era
     (UtxoEntry era, Map (TxIn (EraCrypto era)) (TxOut era),
      Map (TxIn (EraCrypto era)) (TxOut era),
      Map (TxIn (EraCrypto era)) (TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genSpendReferenceInputs"><span class="hs-identifier hs-var hs-var">genSpendReferenceInputs</span></a></span></span><span> </span><span id="local-6989586621681311403"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311403"><span class="hs-identifier hs-var">newUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311402"><span class="annot"><span class="annottext">pairs :: [UtxoEntry era]
</span><a href="#local-6989586621681311402"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311403"><span class="hs-identifier hs-var">newUTxO</span></a></span><span>
</span><span id="line-517"></span><span>  </span><span id="local-6989586621681311400"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311400"><span class="hs-identifier hs-var">maxInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier hs-var">getSpendInputsMax</span></a></span><span>
</span><span id="line-518"></span><span>  </span><span id="local-6989586621681311399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311399"><span class="hs-identifier hs-var">maxRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier hs-var">getRefInputsMax</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span id="local-6989586621681311398"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311398"><span class="hs-identifier hs-var">numInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311403"><span class="hs-identifier hs-var">newUTxO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311400"><span class="hs-identifier hs-var">maxInputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span id="local-6989586621681311396"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311396"><span class="hs-identifier hs-var">numRefInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311399"><span class="hs-identifier hs-var">maxRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>  </span><span id="local-6989586621681311395"><span class="annot"><span class="annottext">TxIn (EraCrypto era) -&gt; Bool
</span><a href="#local-6989586621681311395"><span class="hs-identifier hs-var">badTest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. GenRS era (TxIn (EraCrypto era) -&gt; Bool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier hs-var">getUtxoTest</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681311394"><span class="annot"><span class="annottext">feepair :: UtxoEntry era
</span><a href="#local-6989586621681311394"><span class="hs-identifier hs-var">feepair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621681311393"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311393"><span class="hs-identifier hs-var">txin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311392"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311392"><span class="hs-identifier hs-var">txout</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311391"><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311391"><span class="hs-identifier hs-var">inputPairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Int -&gt; [a] -&gt; Gen (a, [a])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#chooseGood"><span class="hs-identifier hs-var">chooseGood</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn (EraCrypto era) -&gt; Bool
</span><a href="#local-6989586621681311395"><span class="hs-identifier hs-var">badTest</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311398"><span class="hs-identifier hs-var">numInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311402"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621681311389"><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311389"><span class="hs-identifier hs-var">refInputPairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311396"><span class="hs-identifier hs-var">numRefInputs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><span class="hs-identifier hs-var">shuffle</span></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311402"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311388"><span class="annot"><span class="annottext">inputs :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311388"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311391"><span class="hs-identifier hs-var">inputPairs</span></a></span><span>
</span><span id="line-525"></span><span>      </span><span id="local-6989586621681311387"><span class="annot"><span class="annottext">refInputs :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311387"><span class="hs-identifier hs-var hs-var">refInputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621681311389"><span class="hs-identifier hs-var">refInputPairs</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-comment">-- The feepair is added to the mMutFee field</span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (TxIn (EraCrypto era)) (TxOut era)
 -&gt; Map (TxIn (EraCrypto era)) (TxOut era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier hs-var">modifyModelMutFee</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311393"><span class="hs-identifier hs-var">txin</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311392"><span class="hs-identifier hs-var">txout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311385"><span class="annot"><span class="annottext">filtered :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311385"><span class="hs-identifier hs-var hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311403"><span class="hs-identifier hs-var">newUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311388"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311387"><span class="hs-identifier hs-var">refInputs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoEntry era
</span><a href="#local-6989586621681311394"><span class="hs-identifier hs-var">feepair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311388"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311387"><span class="hs-identifier hs-var">refInputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681311385"><span class="hs-identifier hs-var">filtered</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-comment">-- | The invariant is:</span><span>
</span><span id="line-532"></span><span class="hs-comment">--</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- * 'xs' is a non empty list.</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- * 'xs' has at most one 'bad' element</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- * if 'xs' has length 1, then the element is guaranteed to be good.</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- * 'n' is a positive `Int`, ranging between (1 .. length xs).</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- Return a pair (good,ys) where</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- &gt; (bad good)==False,</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- &gt; (good `elem` ys),</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- &gt; (length ys) == n, and</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- &gt; all (`elem` xs) ys.</span><span>
</span><span id="line-542"></span><span class="hs-comment">--</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- This is used to generate the spending inputs, which always contain on</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- Input we can use to pay the fee, that does not come from the oldUTxO.</span><span>
</span><span id="line-545"></span><span id="local-6989586621681312936"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#chooseGood"><span class="hs-identifier hs-type">chooseGood</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681312936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681312936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681312936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681312936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-546"></span><span id="chooseGood"><span class="annot"><span class="annottext">chooseGood :: forall a. (a -&gt; Bool) -&gt; Int -&gt; [a] -&gt; Gen (a, [a])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#chooseGood"><span class="hs-identifier hs-var hs-var">chooseGood</span></a></span></span><span> </span><span id="local-6989586621681311366"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681311366"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span id="local-6989586621681311365"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311365"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681311364"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311364"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311363"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311363"><span class="hs-identifier hs-var">good</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311362"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311362"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311364"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-549"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-550"></span><span>            </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-551"></span><span>              </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty list in chooseGood, should never happen. n = &quot;</span></span><span>
</span><span id="line-552"></span><span>                </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311365"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-553"></span><span>                </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, length xs = &quot;</span></span><span>
</span><span id="line-554"></span><span>                </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311364"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621681311361"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311361"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311361"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681311360"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311360"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681311359"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311359"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681311358"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311358"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621681311366"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311360"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311359"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311360"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311358"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311360"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311359"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311358"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621681311357"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311357"><span class="hs-identifier hs-var">tailx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311365"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><span class="hs-identifier hs-var">shuffle</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311362"><span class="hs-identifier hs-var">others</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span id="local-6989586621681311356"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311356"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen [a]
</span><span class="hs-identifier hs-var">shuffle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311363"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311357"><span class="hs-identifier hs-var">tailx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681311363"><span class="hs-identifier hs-var">good</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681311356"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- ==================================================</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- Generating Certificates, May add to the Model</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-type">genShelleyDelegCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312925"><span class="annot"><a href="#local-6989586621681312925"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312925"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312925"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312925"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span id="genShelleyDelegCert"><span class="annot"><span class="annottext">genShelleyDelegCert :: forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var hs-var">genShelleyDelegCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">75</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621681311343"><span class="hs-identifier hs-var">genShelleyRegCert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">25</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621681311342"><span class="hs-identifier hs-var">genShelleyUnRegCert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621681311341"><span class="hs-identifier hs-var">genDelegation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621681311343"><span class="annot"><span class="annottext">genShelleyRegCert :: RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621681311343"><span class="hs-identifier hs-var hs-var">genShelleyRegCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyEraTxCert era =&gt;
StakeCredential (EraCrypto era) -&gt; TxCert era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RegTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Tag -&gt; GenRS era (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var">genFreshRegCred</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681312925"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621681311342"><span class="annot"><span class="annottext">genShelleyUnRegCert :: RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621681311342"><span class="hs-identifier hs-var hs-var">genShelleyUnRegCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyEraTxCert era =&gt;
StakeCredential (EraCrypto era) -&gt; TxCert era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">UnRegTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Tag -&gt; GenRS era (Credential kr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621681311341"><span class="annot"><span class="annottext">genDelegation :: RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621681311341"><span class="hs-identifier hs-var hs-var">genDelegation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>      </span><span id="local-6989586621681311327"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681311327"><span class="hs-identifier hs-var">rewardAccount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Tag -&gt; GenRS era (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var">genFreshRegCred</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681311326"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311326"><span class="hs-identifier hs-var">poolId</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier hs-var">genPool</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyEraTxCert era =&gt;
StakeCredential (EraCrypto era)
-&gt; KeyHash 'StakePool (EraCrypto era) -&gt; TxCert era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">DelegStakeTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681311327"><span class="hs-identifier hs-var">rewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311326"><span class="hs-identifier hs-var">poolId</span></a></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCertDeleg"><span class="hs-identifier hs-type">genTxCertDeleg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681311324"><span class="annot"><a href="#local-6989586621681311324"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311324"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311324"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681311324"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span id="genTxCertDeleg"><span class="annot"><span class="annottext">genTxCertDeleg :: forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCertDeleg"><span class="hs-identifier hs-var hs-var">genTxCertDeleg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681311324"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-581"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-583"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCert"><span class="hs-identifier hs-type">genTxCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312908"><span class="annot"><a href="#local-6989586621681312908"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312908"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312908"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312908"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span id="genTxCert"><span class="annot"><span class="annottext">genTxCert :: forall era. Reflect era =&gt; SlotNo -&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCert"><span class="hs-identifier hs-var hs-var">genTxCert</span></a></span></span><span> </span><span id="local-6989586621681311256"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681311256"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-590"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span>
</span><span id="line-591"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCertDeleg"><span class="hs-identifier hs-var">genTxCertDeleg</span></a></span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-593"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">75</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxCert era =&gt;
PoolParams (EraCrypto era) -&gt; TxCert era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">RegPoolTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (PoolParams (EraCrypto era))
</span><a href="#local-6989586621681311254"><span class="hs-identifier hs-var">genFreshPool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">25</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxCert era =&gt;
KeyHash 'StakePool (EraCrypto era) -&gt; EpochNo -&gt; TxCert era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">RetirePoolTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier hs-var">genRetirementHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen EpochNo
</span><a href="#local-6989586621681311252"><span class="hs-identifier hs-var">genEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-598"></span><span>    </span><span id="local-6989586621681311254"><span class="annot"><span class="annottext">genFreshPool :: RWST
  (GenEnv era) () (GenState era) Gen (PoolParams (EraCrypto era))
</span><a href="#local-6989586621681311254"><span class="hs-identifier hs-var hs-var">genFreshPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681311246"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311246"><span class="hs-identifier hs-var">_kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311245"><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><a href="#local-6989586621681311245"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS
  era
  (KeyHash 'StakePool (EraCrypto era), PoolParams (EraCrypto era),
   IndividualPoolStake (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><a href="#local-6989586621681311245"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-601"></span><span>    </span><span id="local-6989586621681311252"><span class="annot"><span class="annottext">genEpoch :: RWST (GenEnv era) () (GenState era) Gen EpochNo
</span><a href="#local-6989586621681311252"><span class="hs-identifier hs-var hs-var">genEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-602"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span> </span><span id="local-6989586621681311244"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311244"><span class="hs-identifier hs-var">txEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">epochFromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681311256"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span> </span><span id="local-6989586621681311243"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311243"><span class="hs-identifier hs-var">curEpoch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. ModelNewEpochState era -&gt; EpochNo
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mEL"><span class="hs-identifier hs-var">mEL</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">EpochNo</span></span><span> </span><span id="local-6989586621681311240"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311240"><span class="hs-identifier hs-var">maxEpoch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">forall era. EraPParams era =&gt; Lens' (PParams era) EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">ppEMaxL</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311238"><span class="annot"><span class="annottext">nextEpoch :: Word64
</span><a href="#local-6989586621681311238"><span class="hs-identifier hs-var hs-var">nextEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311244"><span class="hs-identifier hs-var">txEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311243"><span class="hs-identifier hs-var">curEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- This will be either 1 or 2. It is 2 if the Tx is at the epoch boundary</span><span>
</span><span id="line-606"></span><span>      </span><span id="local-6989586621681311237"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311237"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311238"><span class="hs-identifier hs-var">nextEpoch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311240"><span class="hs-identifier hs-var">maxEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><span class="hs-identifier hs-var">EpochNo</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311243"><span class="hs-identifier hs-var">curEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681311237"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-comment">-- getShelleyTxCertDelegG :: forall era. Reflect era =&gt; TxCert era -&gt; Maybe (ShelleyDelegCert (EraCrypto era))</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- getShelleyTxCertDelegG = case reify @era of</span><span>
</span><span id="line-611"></span><span class="hs-comment">--   Shelley _ -&gt; getShelleyTxCertDeleg</span><span>
</span><span id="line-612"></span><span class="hs-comment">--   Mary _ -&gt; getShelleyTxCertDeleg</span><span>
</span><span id="line-613"></span><span class="hs-comment">--   Allegra _ -&gt; getShelleyTxCertDeleg</span><span>
</span><span id="line-614"></span><span class="hs-comment">--   Alonzo _ -&gt; getShelleyTxCertDeleg</span><span>
</span><span id="line-615"></span><span class="hs-comment">--   Babbage _ -&gt; getShelleyTxCertDeleg</span><span>
</span><span id="line-616"></span><span class="hs-comment">--   Conway _ -&gt; getShelleyTxCertDeleg -- TODO write a generator for Conway certs</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-comment">-- mkShelleyTxCertDelegG :: forall era. Reflect era =&gt; ShelleyDelegCert (EraCrypto era) -&gt; TxCert era</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- mkShelleyTxCertDelegG = case reify @era of</span><span>
</span><span id="line-620"></span><span class="hs-comment">--   Shelley _ -&gt; mkShelleyTxCertDeleg</span><span>
</span><span id="line-621"></span><span class="hs-comment">--   Mary _ -&gt; mkShelleyTxCertDeleg</span><span>
</span><span id="line-622"></span><span class="hs-comment">--   Allegra _ -&gt; mkShelleyTxCertDeleg</span><span>
</span><span id="line-623"></span><span class="hs-comment">--   Alonzo _ -&gt; mkShelleyTxCertDeleg</span><span>
</span><span id="line-624"></span><span class="hs-comment">--   Babbage _ -&gt; mkShelleyTxCertDeleg</span><span>
</span><span id="line-625"></span><span class="hs-comment">--   Conway _ -&gt; mkShelleyTxCertDeleg -- TODO write a generator for Conway certs</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCerts"><span class="hs-identifier hs-type">genTxCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312881"><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-628"></span><span id="genTxCerts"><span class="annot"><span class="annottext">genTxCerts :: forall era. Reflect era =&gt; SlotNo -&gt; GenRS era [TxCert era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCerts"><span class="hs-identifier hs-var hs-var">genTxCerts</span></a></span></span><span> </span><span id="local-6989586621681311170"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681311170"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311169"><span class="annot"><span class="annottext">genUniqueScript :: ([TxCert era],
 Set
   (ScriptHash (EraCrypto era),
    Maybe (KeyHash 'StakePool (EraCrypto era))),
 Map (StakeCredential (EraCrypto era)) Coin)
-&gt; Int
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era],
      Set
        (ScriptHash (EraCrypto era),
         Maybe (KeyHash 'StakePool (EraCrypto era))),
      Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311169"><span class="hs-identifier hs-var hs-var">genUniqueScript</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621681311168"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681311167"><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681311166"><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-630"></span><span>        </span><span id="local-6989586621681311165"><span class="annot"><span class="annottext">Set (StakeCredential (EraCrypto era))
</span><a href="#local-6989586621681311165"><span class="hs-identifier hs-var">honest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Set (StakeCredential (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span>
</span><span id="line-631"></span><span>        </span><span id="local-6989586621681311163"><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; SlotNo -&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCert"><span class="hs-identifier hs-var">genTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681311170"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-632"></span><span>        </span><span class="hs-comment">-- Workaround a misfeature where duplicate plutus scripts in TxCert are ignored</span><span>
</span><span id="line-633"></span><span>        </span><span class="hs-comment">-- so if a duplicate might be generated, we don't do that generation</span><span>
</span><span id="line-634"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311162"><span class="annot"><span class="annottext">insertIfNotPresent :: [TxCert era]
-&gt; Map (StakeCredential (EraCrypto era)) Coin
-&gt; Maybe (KeyHash 'StakePool (EraCrypto era))
-&gt; Maybe (IsValid, ScriptHash (EraCrypto era))
-&gt; ([TxCert era],
    Set
      (ScriptHash (EraCrypto era),
       Maybe (KeyHash 'StakePool (EraCrypto era))),
    Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311162"><span class="hs-identifier hs-var hs-var">insertIfNotPresent</span></a></span></span><span> </span><span id="local-6989586621681311161"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311161"><span class="hs-identifier hs-var">dcs'</span></a></span></span><span> </span><span id="local-6989586621681311160"><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311160"><span class="hs-identifier hs-var">regCreds'</span></a></span></span><span> </span><span id="local-6989586621681311159"><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621681311159"><span class="hs-identifier hs-var">mKey</span></a></span></span><span> </span><span id="local-6989586621681311158"><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681311158"><span class="hs-identifier hs-var">mScriptHash</span></a></span></span><span>
</span><span id="line-635"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsValid
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311157"><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311157"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681311158"><span class="hs-identifier hs-var">mScriptHash</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-636"></span><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311157"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621681311159"><span class="hs-identifier hs-var">mKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-637"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311161"><span class="hs-identifier hs-var">dcs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><a href="#local-6989586621681311157"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool (EraCrypto era))
</span><a href="#local-6989586621681311159"><span class="hs-identifier hs-var">mKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311160"><span class="hs-identifier hs-var">regCreds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311161"><span class="hs-identifier hs-var">dcs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311160"><span class="hs-identifier hs-var">regCreds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>        </span><span class="hs-comment">-- Generate registration and de-registration delegation certificates,</span><span>
</span><span id="line-641"></span><span>        </span><span class="hs-comment">-- while ensuring the proper registered/unregistered state in DState</span><span>
</span><span id="line-642"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-643"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">RegPoolTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">RetirePoolTxCert</span></a></span><span> </span><span id="local-6989586621681311154"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311154"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-645"></span><span>            </span><span class="hs-comment">-- We need to make sure that the pool is registered before</span><span>
</span><span id="line-646"></span><span>            </span><span class="hs-comment">-- we try to retire it</span><span>
</span><span id="line-647"></span><span>            </span><span id="local-6989586621681311153"><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621681311153"><span class="hs-identifier hs-var">modelPools</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map
     (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolParams"><span class="hs-identifier hs-var">mPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span>
</span><span id="line-648"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311154"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  (KeyHash 'StakePool (EraCrypto era)) (PoolParams (EraCrypto era))
</span><a href="#local-6989586621681311153"><span class="hs-identifier hs-var">modelPools</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-649"></span><span>              </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>              </span><span class="annot"><span class="annottext">Maybe (PoolParams (EraCrypto era))
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">RegTxCert</span></a></span><span> </span><span id="local-6989586621681311151"><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311151"><span class="hs-identifier hs-var">regCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-652"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311151"><span class="hs-identifier hs-var">regCred</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span> </span><span class="hs-comment">-- Can't register if it is already registered</span><span>
</span><span id="line-653"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311151"><span class="hs-identifier hs-var">regCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">99</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 99 is a NonZero Value</span><span>
</span><span id="line-655"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">UnRegTxCert</span></a></span><span> </span><span id="local-6989586621681311148"><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311148"><span class="hs-identifier hs-var">deregCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-656"></span><span>            </span><span class="hs-comment">-- We can't make ShelleyUnRegCert certificate if deregCred is not already registered</span><span>
</span><span id="line-657"></span><span>            </span><span class="hs-comment">-- or if the Rewards balance for deregCred is not 0,</span><span>
</span><span id="line-658"></span><span>            </span><span class="hs-comment">-- or if the credential is one of the StableDelegators (which are never de-registered)</span><span>
</span><span id="line-659"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311148"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-660"></span><span>              </span><span class="annot"><span class="annottext">Maybe Coin
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>              </span><span class="hs-comment">-- No credential, skip making certificate</span><span>
</span><span id="line-662"></span><span>              </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>                </span><span class="hs-comment">-- Ok to make certificate, rewards balance is 0</span><span>
</span><span id="line-664"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311148"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Set (StakeCredential (EraCrypto era))
</span><a href="#local-6989586621681311165"><span class="hs-identifier hs-var">honest</span></a></span><span>
</span><span id="line-665"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-667"></span><span>                    </span><span class="annot"><span class="annottext">[TxCert era]
-&gt; Map (StakeCredential (EraCrypto era)) Coin
-&gt; Maybe (KeyHash 'StakePool (EraCrypto era))
-&gt; Maybe (IsValid, ScriptHash (EraCrypto era))
-&gt; ([TxCert era],
    Set
      (ScriptHash (EraCrypto era),
       Maybe (KeyHash 'StakePool (EraCrypto era))),
    Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311162"><span class="hs-identifier hs-var">insertIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311148"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-668"></span><span>                      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (k :: KeyRole) era.
Credential k (EraCrypto era)
-&gt; Tag -&gt; GenRS era (Maybe (IsValid, ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupPlutusScript"><span class="hs-identifier hs-var">lookupPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311148"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span>
</span><span id="line-669"></span><span>              </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>          </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">DelegStakeTxCert</span></a></span><span> </span><span id="local-6989586621681311146"><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311146"><span class="hs-identifier hs-var">delegCred</span></a></span></span><span> </span><span id="local-6989586621681311145"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311145"><span class="hs-identifier hs-var">delegKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-671"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311144"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311144"><span class="hs-identifier hs-var">dcs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311143"><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311143"><span class="hs-identifier hs-var">regCreds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-672"></span><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311146"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span>
</span><span id="line-673"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- In order to Delegate, the delegCred must exist in rewards.</span><span>
</span><span id="line-675"></span><span>                    </span><span class="hs-comment">-- so if it is not there, we put it there, otherwise we may</span><span>
</span><span id="line-676"></span><span>                    </span><span class="hs-comment">-- never generate a valid delegation.</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ShelleyEraTxCert era =&gt;
StakeCredential (EraCrypto era) -&gt; TxCert era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-var">RegTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311146"><span class="hs-identifier hs-var">delegCred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span>
</span><span id="line-679"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311146"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">99</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span>
</span><span id="line-680"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[TxCert era]
-&gt; Map (StakeCredential (EraCrypto era)) Coin
-&gt; Maybe (KeyHash 'StakePool (EraCrypto era))
-&gt; Maybe (IsValid, ScriptHash (EraCrypto era))
-&gt; ([TxCert era],
    Set
      (ScriptHash (EraCrypto era),
       Maybe (KeyHash 'StakePool (EraCrypto era))),
    Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311162"><span class="hs-identifier hs-var">insertIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311144"><span class="hs-identifier hs-var">dcs'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311143"><span class="hs-identifier hs-var">regCreds'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681311145"><span class="hs-identifier hs-var">delegKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (k :: KeyRole) era.
Credential k (EraCrypto era)
-&gt; Tag -&gt; GenRS era (Maybe (IsValid, ScriptHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupPlutusScript"><span class="hs-identifier hs-var">lookupPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">StakeCredential (EraCrypto era)
</span><a href="#local-6989586621681311146"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span>
</span><span id="line-683"></span><span>          </span><span class="annot"><span class="annottext">TxCert era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621681311163"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311168"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><a href="#local-6989586621681311167"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311166"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>  </span><span id="local-6989586621681311142"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311142"><span class="hs-identifier hs-var">maxcert</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier hs-var">getCertificateMax</span></a></span><span>
</span><span id="line-685"></span><span>  </span><span id="local-6989586621681311141"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311141"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311142"><span class="hs-identifier hs-var">maxcert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>  </span><span id="local-6989586621681311140"><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311140"><span class="hs-identifier hs-var">reward</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mRewards"><span class="hs-identifier hs-var">mRewards</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681311138"><span class="hs-identifier hs-type">initSets</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-688"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312881"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>      </span><span id="local-6989586621681311138"><span class="annot"><span class="annottext">initSets :: ([TxCert era],
 Set
   (ScriptHash (EraCrypto era),
    Maybe (KeyHash 'StakePool (EraCrypto era))),
 Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311138"><span class="hs-identifier hs-var hs-var">initSets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><a href="#local-6989586621681311140"><span class="hs-identifier hs-var">reward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681311136"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311136"><span class="hs-identifier hs-var">dcs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set
  (ScriptHash (EraCrypto era),
   Maybe (KeyHash 'StakePool (EraCrypto era)))
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (StakeCredential (EraCrypto era)) Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.foldlM</span></a></span><span> </span><span class="annot"><span class="annottext">([TxCert era],
 Set
   (ScriptHash (EraCrypto era),
    Maybe (KeyHash 'StakePool (EraCrypto era))),
 Map (StakeCredential (EraCrypto era)) Coin)
-&gt; Int
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era],
      Set
        (ScriptHash (EraCrypto era),
         Maybe (KeyHash 'StakePool (EraCrypto era))),
      Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311169"><span class="hs-identifier hs-var">genUniqueScript</span></a></span><span> </span><span class="annot"><span class="annottext">([TxCert era],
 Set
   (ScriptHash (EraCrypto era),
    Maybe (KeyHash 'StakePool (EraCrypto era))),
 Map (StakeCredential (EraCrypto era)) Coin)
</span><a href="#local-6989586621681311138"><span class="hs-identifier hs-var">initSets</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311141"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681311136"><span class="hs-identifier hs-var">dcs</span></a></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span id="local-6989586621681312869"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#spendOnly"><span class="hs-identifier hs-type">spendOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312869"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312869"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-697"></span><span id="spendOnly"><span class="annot"><span class="annottext">spendOnly :: forall era. EraTxOut era =&gt; TxOut era -&gt; Bool
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#spendOnly"><span class="hs-identifier hs-var hs-var">spendOnly</span></a></span></span><span> </span><span id="local-6989586621681311130"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311130"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311130"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
Lens' (TxOut era) (Addr (EraCrypto era))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">addrTxOutL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-698"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StakeReference (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-699"></span><span>  </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-comment">-- | Generate a set of Collateral inputs sufficient to pay the minimum fee ('minCollTotal') computed</span><span>
</span><span id="line-702"></span><span class="hs-comment">--   from the fee and the collateralPercentage from the PParams. Return the new UTxO, the inputs,</span><span>
</span><span id="line-703"></span><span class="hs-comment">--   and coin of the excess amount included in the inputs, above what is needed to pay the minimum fee.</span><span>
</span><span id="line-704"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCollateralUTxO"><span class="hs-identifier hs-type">genCollateralUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312867"><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-708"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-709"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-710"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span id="genCollateralUTxO"><span class="annot"><span class="annottext">genCollateralUTxO :: forall era.
(HasCallStack, Reflect era) =&gt;
[Addr (EraCrypto era)]
-&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCollateralUTxO"><span class="hs-identifier hs-var hs-var">genCollateralUTxO</span></a></span></span><span> </span><span id="local-6989586621681311049"><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311049"><span class="hs-identifier hs-var">collateralAddresses</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621681311048"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681311048"><span class="hs-identifier hs-var">fee</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681311047"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311047"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-712"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621681311046"><span class="annot"><span class="annottext">PParams era
gePParams :: PParams era
gePParams :: forall era. GenEnv era -&gt; PParams era
</span><a href="#local-6989586621681311046"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681311045"><span class="annot"><span class="annottext">collPerc :: Natural
</span><a href="#local-6989586621681311045"><span class="hs-identifier hs-var hs-var">collPerc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; PParams era -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#collateralPercentage%27"><span class="hs-identifier hs-var">collateralPercentage'</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681311046"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-714"></span><span>      </span><span id="local-6989586621681311043"><span class="annot"><span class="annottext">minCollTotal :: Coin
</span><a href="#local-6989586621681311043"><span class="hs-identifier hs-var hs-var">minCollTotal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">ceiling</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681311048"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621681311045"><span class="hs-identifier hs-var">collPerc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>      </span><span class="hs-comment">-- Generate a collateral that is neither in UTxO map nor has already been generated</span><span>
</span><span id="line-716"></span><span>      </span><span id="local-6989586621681311040"><span class="annot"><span class="annottext">genNewCollateral :: Addr (EraCrypto era)
-&gt; MUtxo era
-&gt; MUtxo era
-&gt; Coin
-&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311040"><span class="hs-identifier hs-var hs-var">genNewCollateral</span></a></span></span><span> </span><span id="local-6989586621681311039"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311039"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621681311038"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311038"><span class="hs-identifier hs-var">coll</span></a></span></span><span> </span><span id="local-6989586621681311037"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311037"><span class="hs-identifier hs-var">um</span></a></span></span><span> </span><span id="local-6989586621681311036"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311036"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-comment">-- The size of the Gen computation is driven down when we generate scripts, so it can be 0 here</span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-comment">-- that is really bad, because if the happens we get the same TxIn every time, and 'coll' never grows,</span><span>
</span><span id="line-719"></span><span>        </span><span class="hs-comment">-- so this function doesn't terminate. We want many choices of TxIn, so resize just this arbitrary by 30.</span><span>
</span><span id="line-720"></span><span>        </span><span id="local-6989586621681311035"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311035"><span class="hs-identifier hs-var">entriesInUse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span>
</span><span id="line-721"></span><span>        </span><span id="local-6989586621681311034"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311034"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; Gen a -&gt; Gen a
</span><span class="hs-identifier hs-var">resize</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311034"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311047"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311034"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311038"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311034"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311035"><span class="hs-identifier hs-var">entriesInUse</span></a></span><span>
</span><span id="line-723"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
-&gt; MUtxo era
-&gt; MUtxo era
-&gt; Coin
-&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311040"><span class="hs-identifier hs-var">genNewCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311039"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311038"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311037"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311036"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-724"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311037"><span class="hs-identifier hs-var">um</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311034"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Addr (EraCrypto era) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311039"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Value era -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Amount"><span class="hs-identifier hs-var">Amount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311036"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311038"><span class="hs-identifier hs-var">coll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311036"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>      </span><span class="hs-comment">-- Either pick a collateral from a map or generate a completely new one</span><span>
</span><span id="line-726"></span><span>      </span><span id="local-6989586621681311031"><span class="annot"><span class="annottext">genCollateral :: Addr (EraCrypto era)
-&gt; MUtxo era -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311031"><span class="hs-identifier hs-var hs-var">genCollateral</span></a></span></span><span> </span><span id="local-6989586621681311030"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311030"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621681311029"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311029"><span class="hs-identifier hs-var">coll</span></a></span></span><span> </span><span id="local-6989586621681311028"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311028"><span class="hs-identifier hs-var">um</span></a></span></span><span>
</span><span id="line-727"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311028"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
-&gt; MUtxo era
-&gt; MUtxo era
-&gt; Coin
-&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311040"><span class="hs-identifier hs-var">genNewCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311030"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311029"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311028"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-728"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-729"></span><span>            </span><span id="local-6989586621681311026"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311026"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><span class="hs-identifier hs-var">chooseInt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311028"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681311024"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311024"><span class="hs-identifier hs-var">txIn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311023"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311023"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><span class="hs-identifier hs-var">Map.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311026"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311028"><span class="hs-identifier hs-var">um</span></a></span><span>
</span><span id="line-731"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Int -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.deleteAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681311026"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311028"><span class="hs-identifier hs-var">um</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681311024"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311023"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311029"><span class="hs-identifier hs-var">coll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681311023"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall era. (HasCallStack, EraTxOut era) =&gt; Lens' (TxOut era) Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coinTxOutL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>      </span><span class="hs-comment">-- Recursively either pick existing key spend only outputs or generate new ones that</span><span>
</span><span id="line-733"></span><span>      </span><span class="hs-comment">-- will be later added to the UTxO map</span><span>
</span><span id="line-734"></span><span>      </span><span class="annot"><a href="#local-6989586621681311019"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-735"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-736"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-737"></span><span>        </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-738"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-739"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>      </span><span id="local-6989586621681311019"><span class="annot"><span class="annottext">go :: [Addr (EraCrypto era)]
-&gt; MUtxo era -&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, Coin)
</span><a href="#local-6989586621681311019"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681311018"><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311018"><span class="hs-identifier hs-var">ecs</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681311017"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311017"><span class="hs-identifier hs-var">coll</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681311016"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311016"><span class="hs-identifier hs-var">curCollTotal</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681311015"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311015"><span class="hs-identifier hs-var">um</span></a></span></span><span>
</span><span id="line-741"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311016"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311043"><span class="hs-identifier hs-var">minCollTotal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311017"><span class="hs-identifier hs-var">coll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311016"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311043"><span class="hs-identifier hs-var">minCollTotal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-742"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311018"><span class="hs-identifier hs-var">ecs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Impossible: supplied less addresses than `maxCollateralInputs`&quot;</span></span><span>
</span><span id="line-743"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681311013"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311013"><span class="hs-identifier hs-var">ec</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681311012"><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311012"><span class="hs-identifier hs-var">ecs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311018"><span class="hs-identifier hs-var">ecs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-744"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681311011"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311011"><span class="hs-identifier hs-var">um'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311010"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311010"><span class="hs-identifier hs-var">coll'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311009"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311009"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-745"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311012"><span class="hs-identifier hs-var">ecs'</span></a></span><span>
</span><span id="line-746"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- This is the last input, so most of the time, put something (val &gt; 0)</span><span>
</span><span id="line-747"></span><span>                </span><span class="hs-comment">-- extra in it or we will always have a ColReturn with zero in it.</span><span>
</span><span id="line-748"></span><span>                </span><span class="hs-keyword">do</span><span>
</span><span id="line-749"></span><span>                  </span><span id="local-6989586621681311008"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311008"><span class="hs-identifier hs-var">excess</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-750"></span><span>                  </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
-&gt; MUtxo era
-&gt; MUtxo era
-&gt; Coin
-&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311040"><span class="hs-identifier hs-var">genNewCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311013"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311017"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311015"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311043"><span class="hs-identifier hs-var">minCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311016"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311008"><span class="hs-identifier hs-var">excess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Addr (EraCrypto era)
-&gt; MUtxo era -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311031"><span class="hs-identifier hs-var">genCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311013"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311017"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
-&gt; MUtxo era -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="#local-6989586621681311031"><span class="hs-identifier hs-var">genCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681311013"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311017"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311015"><span class="hs-identifier hs-var">um</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-752"></span><span>            </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
-&gt; MUtxo era -&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, Coin)
</span><a href="#local-6989586621681311019"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311012"><span class="hs-identifier hs-var">ecs'</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311010"><span class="hs-identifier hs-var">coll'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311016"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311009"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311011"><span class="hs-identifier hs-var">um'</span></a></span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681311005"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311005"><span class="hs-identifier hs-var">collaterals</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681311004"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311004"><span class="hs-identifier hs-var">excessColCoin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
-&gt; MUtxo era -&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, Coin)
</span><a href="#local-6989586621681311019"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681311049"><span class="hs-identifier hs-var">collateralAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="annot"><span class="annottext">forall era. EraTxOut era =&gt; TxOut era -&gt; Bool
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#spendOnly"><span class="hs-identifier hs-var">spendOnly</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311047"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-755"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311005"><span class="hs-identifier hs-var">collaterals</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311047"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681311005"><span class="hs-identifier hs-var">collaterals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681311004"><span class="hs-identifier hs-var">excessColCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="hs-comment">-- | This function is used to generate the Outputs of a TxBody, It is computed by taking the</span><span>
</span><span id="line-758"></span><span class="hs-comment">--   Outputs of the range of the (UTxO resticted by the Inputs of the TxBody),</span><span>
</span><span id="line-759"></span><span class="hs-comment">--   as input to the function, and then making new Outputs, where the sum of the Coin is the same.</span><span>
</span><span id="line-760"></span><span class="hs-comment">--   This way we generate a 'balanced' TxBody (modulo fees, deposits, refunds etc. which are</span><span>
</span><span id="line-761"></span><span class="hs-comment">--   handled separately). The idea is to make sum(txOuts) == sum(genRecipientsFrom txouts), the</span><span>
</span><span id="line-762"></span><span class="hs-comment">--   sum will be the same, but the size may be different.</span><span>
</span><span id="line-763"></span><span id="local-6989586621681312848"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipientsFrom"><span class="hs-identifier hs-type">genRecipientsFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312848"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312848"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312848"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312848"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-764"></span><span id="genRecipientsFrom"><span class="annot"><span class="annottext">genRecipientsFrom :: forall era. Reflect era =&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipientsFrom"><span class="hs-identifier hs-var hs-var">genRecipientsFrom</span></a></span></span><span> </span><span id="local-6989586621681310956"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310956"><span class="hs-identifier hs-var">txOuts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-765"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310955"><span class="annot"><span class="annottext">outCount :: Int
</span><a href="#local-6989586621681310955"><span class="hs-identifier hs-var hs-var">outCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310956"><span class="hs-identifier hs-var">txOuts</span></a></span><span>
</span><span id="line-766"></span><span>  </span><span id="local-6989586621681310954"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310954"><span class="hs-identifier hs-var">approxCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310955"><span class="hs-identifier hs-var">outCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310953"><span class="annot"><span class="annottext">extra :: Int
</span><a href="#local-6989586621681310953"><span class="hs-identifier hs-var hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310955"><span class="hs-identifier hs-var">outCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310954"><span class="hs-identifier hs-var">approxCount</span></a></span><span>
</span><span id="line-768"></span><span>      </span><span id="local-6989586621681310952"><span class="annot"><span class="annottext">avgExtra :: Int
</span><a href="#local-6989586621681310952"><span class="hs-identifier hs-var hs-var">avgExtra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">ceiling</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310953"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310954"><span class="hs-identifier hs-var">approxCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>      </span><span id="local-6989586621681310951"><span class="annot"><span class="annottext">genExtra :: Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
</span><a href="#local-6989586621681310951"><span class="hs-identifier hs-var hs-var">genExtra</span></a></span></span><span> </span><span id="local-6989586621681310950"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310950"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-770"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310950"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310952"><span class="hs-identifier hs-var">avgExtra</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-771"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><span class="hs-identifier hs-var">chooseInt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310952"><span class="hs-identifier hs-var">avgExtra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310949"><span class="annot"><span class="annottext">goNew :: Int -&gt; [TxOut era] -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621681310949"><span class="hs-identifier hs-var hs-var">goNew</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310948"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310948"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310948"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-773"></span><span>      </span><span class="annot"><a href="#local-6989586621681310949"><span class="hs-identifier hs-var">goNew</span></a></span><span> </span><span id="local-6989586621681310947"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310947"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681310946"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310946"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681310945"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310945"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310944"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310944"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-774"></span><span>        </span><span id="local-6989586621681310943"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310943"><span class="hs-identifier hs-var">leftToAdd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
</span><a href="#local-6989586621681310951"><span class="hs-identifier hs-var">genExtra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310947"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-775"></span><span>        </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; [TxOut era]
-&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621681310942"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310947"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310943"><span class="hs-identifier hs-var">leftToAdd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310943"><span class="hs-identifier hs-var">leftToAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310946"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310945"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310944"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-776"></span><span>      </span><span id="local-6989586621681310942"><span class="annot"><span class="annottext">goExtra :: Int
-&gt; Int
-&gt; Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; [TxOut era]
-&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621681310942"><span class="hs-identifier hs-var hs-var">goExtra</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681310941"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310941"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681310940"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310940"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310939"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310939"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {era}.
Reflect era =&gt;
Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
</span><a href="#local-6989586621681310938"><span class="hs-identifier hs-var">genWithChange</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310941"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310940"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310939"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-777"></span><span>      </span><span class="annot"><a href="#local-6989586621681310942"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span id="local-6989586621681310937"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310937"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621681310936"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310936"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681310935"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310935"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621681310934"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310934"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310933"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310933"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TxOut era] -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621681310949"><span class="hs-identifier hs-var">goNew</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310937"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310934"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall {era}.
Reflect era =&gt;
Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
</span><a href="#local-6989586621681310938"><span class="hs-identifier hs-var">genWithChange</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310936"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310935"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310933"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-778"></span><span>      </span><span class="annot"><a href="#local-6989586621681310942"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span id="local-6989586621681310932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310932"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681310931"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310931"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310930"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310930"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681310929"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310929"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681310928"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310928"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681310927"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310927"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310926"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310926"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; [TxOut era]
-&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621681310942"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310932"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310931"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310930"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310925"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310928"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310927"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310926"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-779"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-780"></span><span>          </span><span id="local-6989586621681310925"><span class="annot"><span class="annottext">v :: Value era
</span><a href="#local-6989586621681310925"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310929"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall era. EraTxOut era =&gt; Lens' (TxOut era) (Value era)
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">valueTxOutL</span></a></span><span>
</span><span id="line-781"></span><span>      </span><span class="hs-comment">-- Potentially split 'txout' into two TxOuts. If the two piece path is used</span><span>
</span><span id="line-782"></span><span>      </span><span class="hs-comment">-- one of two TxOuts uses the same 'addr' as 'txout' and holds the 'change'</span><span>
</span><span id="line-783"></span><span>      </span><span class="hs-comment">-- (i.e. difference between the original and the second, non-change, TxOut).</span><span>
</span><span id="line-784"></span><span>      </span><span class="hs-comment">-- In either case whether it adds 1 or 2 TxOuts to 'rs', the coin value of</span><span>
</span><span id="line-785"></span><span>      </span><span class="hs-comment">-- the new TxOut(s), is the same as the coin value of 'txout'.</span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621681310938"><span class="annot"><span class="annottext">genWithChange :: Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
</span><a href="#local-6989586621681310938"><span class="hs-identifier hs-var hs-var">genWithChange</span></a></span></span><span> </span><span id="local-6989586621681310885"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310885"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681310884"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310884"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span id="local-6989586621681310883"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310883"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-787"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621681310882"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681310882"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310881"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310881"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310880"><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681310880"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; TxOut era -&gt; (Addr (EraCrypto era), Value era, [TxOutField era])
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutFields"><span class="hs-identifier hs-var">txoutFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310884"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-788"></span><span>            </span><span id="local-6989586621681310878"><span class="annot"><span class="annottext">vCoin :: Integer
</span><a href="#local-6989586621681310878"><span class="hs-identifier hs-var hs-var">vCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coin</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310881"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681310878"><span class="hs-identifier hs-var">vCoin</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- If the coin balance is 0, don't add any TxOuts to 'rs'</span><span>
</span><span id="line-790"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310883"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-791"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-792"></span><span>            </span><span id="local-6989586621681310875"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310875"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681310878"><span class="hs-identifier hs-var">vCoin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>            </span><span id="local-6989586621681310874"><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681310874"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Value era -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310885"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310875"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-795"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310875"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coin</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310881"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-796"></span><span>                </span><span class="hs-keyword">then</span><span>
</span><span id="line-797"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681310872"><span class="annot"><span class="annottext">change :: TxOut era
</span><a href="#local-6989586621681310872"><span class="hs-identifier hs-var hs-var">change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Addr (EraCrypto era) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681310882"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Value era -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Amount"><span class="hs-identifier hs-var">Amount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621681310881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310875"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681310880"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681310874"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310872"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310883"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-799"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutField era]
</span><a href="#local-6989586621681310874"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310883"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-800"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; [TxOut era] -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621681310949"><span class="hs-identifier hs-var">goNew</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310953"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310956"><span class="hs-identifier hs-var">txOuts</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getTxCertCredential"><span class="hs-identifier hs-type">getTxCertCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312844"><span class="annot"><a href="#local-6989586621681312844"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312844"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312844"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312844"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span id="getTxCertCredential"><span class="annot"><span class="annottext">getTxCertCredential :: forall era.
Reflect era =&gt;
TxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getTxCertCredential"><span class="hs-identifier hs-var hs-var">getTxCertCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681312844"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-804"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-805"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-806"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-807"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-808"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-809"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
ConwayTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span id="local-6989586621681312841"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-type">getShelleyTxCertCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyTxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312841"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312841"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-812"></span><span id="getShelleyTxCertCredential"><span class="annot"><span class="annottext">getShelleyTxCertCredential :: forall era.
ShelleyTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var hs-var">getShelleyTxCertCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-813"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyTxCertDelegCert</span></a></span><span> </span><span id="local-6989586621681310850"><span class="annot"><span class="annottext">ShelleyDelegCert (EraCrypto era)
</span><a href="#local-6989586621681310850"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-814"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShelleyDelegCert (EraCrypto era)
</span><a href="#local-6989586621681310850"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-815"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyRegCert</span></a></span><span> </span><span id="local-6989586621681310848"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310848"><span class="hs-identifier hs-var">_rk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-comment">-- we don't require witnesses for ShelleyRegCert</span><span>
</span><span id="line-816"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyUnRegCert</span></a></span><span> </span><span id="local-6989586621681310846"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310846"><span class="hs-identifier hs-var">drk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310846"><span class="hs-identifier hs-var">drk</span></a></span><span>
</span><span id="line-817"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyDelegCert</span></a></span><span> </span><span id="local-6989586621681310844"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310844"><span class="hs-identifier hs-var">dk</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310844"><span class="hs-identifier hs-var">dk</span></a></span><span>
</span><span id="line-818"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyTxCertPool</span></a></span><span> </span><span id="local-6989586621681310842"><span class="annot"><span class="annottext">PoolCert (EraCrypto era)
</span><a href="#local-6989586621681310842"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-819"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PoolCert (EraCrypto era)
</span><a href="#local-6989586621681310842"><span class="hs-identifier hs-var">pc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">RegPool</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621681310831"><span id="local-6989586621681310832"><span id="local-6989586621681310833"><span id="local-6989586621681310834"><span id="local-6989586621681310835"><span id="local-6989586621681310836"><span id="local-6989586621681310837"><span id="local-6989586621681310838"><span id="local-6989586621681310839"><span class="annot"><span class="annottext">Set (KeyHash 'Staking (EraCrypto era))
StrictMaybe PoolMetadata
Coin
RewardAcnt (EraCrypto era)
StrictSeq StakePoolRelay
UnitInterval
KeyHash 'StakePool (EraCrypto era)
Hash (EraCrypto era) (VerKeyVRF (EraCrypto era))
ppId :: forall c. PoolParams c -&gt; KeyHash 'StakePool c
ppVrf :: forall c. PoolParams c -&gt; Hash c (VerKeyVRF c)
ppPledge :: forall c. PoolParams c -&gt; Coin
ppCost :: forall c. PoolParams c -&gt; Coin
ppMargin :: forall c. PoolParams c -&gt; UnitInterval
ppRewardAcnt :: forall c. PoolParams c -&gt; RewardAcnt c
ppOwners :: forall c. PoolParams c -&gt; Set (KeyHash 'Staking c)
ppRelays :: forall c. PoolParams c -&gt; StrictSeq StakePoolRelay
ppMetadata :: forall c. PoolParams c -&gt; StrictMaybe PoolMetadata
ppMetadata :: StrictMaybe PoolMetadata
ppRelays :: StrictSeq StakePoolRelay
ppOwners :: Set (KeyHash 'Staking (EraCrypto era))
ppRewardAcnt :: RewardAcnt (EraCrypto era)
ppMargin :: UnitInterval
ppCost :: Coin
ppPledge :: Coin
ppVrf :: Hash (EraCrypto era) (VerKeyVRF (EraCrypto era))
ppId :: KeyHash 'StakePool (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681310839"><span class="hs-identifier hs-var">ppId</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">RetirePool</span></a></span><span> </span><span id="local-6989586621681310820"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681310820"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681310820"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-822"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyTxCertGenesisDeleg</span></a></span><span> </span><span id="local-6989586621681310818"><span class="annot"><span class="annottext">GenesisDelegCert (EraCrypto era)
</span><a href="#local-6989586621681310818"><span class="hs-identifier hs-var">_g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-823"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">ShelleyTxCertMir</span></a></span><span> </span><span id="local-6989586621681310816"><span class="annot"><span class="annottext">MIRCert (EraCrypto era)
</span><a href="#local-6989586621681310816"><span class="hs-identifier hs-var">_m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span id="local-6989586621681312834"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-type">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312834"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312834"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-826"></span><span id="getConwayTxCertCredential"><span class="annot"><span class="annottext">getConwayTxCertCredential :: forall era.
ConwayTxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var hs-var">getConwayTxCertCredential</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertPool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">RegPool</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621681310804"><span id="local-6989586621681310805"><span id="local-6989586621681310806"><span id="local-6989586621681310807"><span id="local-6989586621681310808"><span id="local-6989586621681310809"><span id="local-6989586621681310810"><span id="local-6989586621681310811"><span id="local-6989586621681310812"><span class="annot"><span class="annottext">Set (KeyHash 'Staking (EraCrypto era))
StrictMaybe PoolMetadata
Coin
RewardAcnt (EraCrypto era)
StrictSeq StakePoolRelay
UnitInterval
KeyHash 'StakePool (EraCrypto era)
Hash (EraCrypto era) (VerKeyVRF (EraCrypto era))
ppMetadata :: StrictMaybe PoolMetadata
ppRelays :: StrictSeq StakePoolRelay
ppOwners :: Set (KeyHash 'Staking (EraCrypto era))
ppRewardAcnt :: RewardAcnt (EraCrypto era)
ppMargin :: UnitInterval
ppCost :: Coin
ppPledge :: Coin
ppVrf :: Hash (EraCrypto era) (VerKeyVRF (EraCrypto era))
ppId :: KeyHash 'StakePool (EraCrypto era)
ppId :: forall c. PoolParams c -&gt; KeyHash 'StakePool c
ppVrf :: forall c. PoolParams c -&gt; Hash c (VerKeyVRF c)
ppPledge :: forall c. PoolParams c -&gt; Coin
ppCost :: forall c. PoolParams c -&gt; Coin
ppMargin :: forall c. PoolParams c -&gt; UnitInterval
ppRewardAcnt :: forall c. PoolParams c -&gt; RewardAcnt c
ppOwners :: forall c. PoolParams c -&gt; Set (KeyHash 'Staking c)
ppRelays :: forall c. PoolParams c -&gt; StrictSeq StakePoolRelay
ppMetadata :: forall c. PoolParams c -&gt; StrictMaybe PoolMetadata
</span><a href="#local-6989586621681310804"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681310812"><span class="hs-identifier hs-var">ppId</span></a></span><span>
</span><span id="line-827"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertPool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">RetirePool</span></a></span><span> </span><span id="local-6989586621681310803"><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681310803"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) c (r' :: KeyRole).
HasKeyRole a =&gt;
a r c -&gt; a r' c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) c. KeyHash kr c -&gt; Credential kr c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool (EraCrypto era)
</span><a href="#local-6989586621681310803"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-828"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayRegCert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-829"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayUnRegCert</span></a></span><span> </span><span id="local-6989586621681310799"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310799"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310799"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-830"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayDelegCert</span></a></span><span> </span><span id="local-6989586621681310797"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310797"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Delegatee (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310797"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-831"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayRegDelegCert</span></a></span><span> </span><span id="local-6989586621681310795"><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310795"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Delegatee (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking (EraCrypto era)
</span><a href="#local-6989586621681310795"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-832"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-conway-1.7.0.0/doc/html/cardano-ledger-conway/src"><span class="hs-identifier hs-type">ConwayTxCertGov</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovCert (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span id="local-6989586621681312809"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genWithdrawals"><span class="hs-identifier hs-type">genWithdrawals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312809"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312809"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Withdrawals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312809"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-1.5.0.0/doc/html/cardano-ledger-shelley/src"><span class="hs-identifier hs-type">RewardAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312809"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-835"></span><span id="genWithdrawals"><span class="annot"><span class="annottext">genWithdrawals :: forall era.
Reflect era =&gt;
SlotNo
-&gt; GenRS
     era (Withdrawals (EraCrypto era), RewardAccounts (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genWithdrawals"><span class="hs-identifier hs-var hs-var">genWithdrawals</span></a></span></span><span> </span><span id="local-6989586621681310779"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310779"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-836"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; EpochNo
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">epochFromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310779"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><span class="hs-identifier hs-var">EpochNo</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-837"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-838"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310778"><span class="annot"><span class="annottext">networkId :: Network
</span><a href="#local-6989586621681310778"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Testnet</span></a></span><span>
</span><span id="line-839"></span><span>      </span><span id="local-6989586621681310777"><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310777"><span class="hs-identifier hs-var">newRewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS era (RewardAccounts (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier hs-var">genRewards</span></a></span><span>
</span><span id="line-840"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (RewardAcnt c) Coin -&gt; Withdrawals c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Withdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">Map.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Network -&gt; Credential 'Staking c -&gt; RewardAcnt c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">RewardAcnt</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621681310778"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310777"><span class="hs-identifier hs-var">newRewards</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310777"><span class="hs-identifier hs-var">newRewards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Map (RewardAcnt c) Coin -&gt; Withdrawals c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Withdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#timeToLive"><span class="hs-identifier hs-type">timeToLive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-844"></span><span id="timeToLive"><span class="annot"><span class="annottext">timeToLive :: ValidityInterval -&gt; SlotNo
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#timeToLive"><span class="hs-identifier hs-var hs-var">timeToLive</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span id="local-6989586621681310771"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310771"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310771"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-845"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#timeToLive"><span class="hs-identifier hs-var">timeToLive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-allegra-1.2.1.1/doc/html/cardano-ledger-allegra/src"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><span class="hs-identifier hs-var">SNothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><span class="hs-identifier hs-var">SlotNo</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span id="local-6989586621681312796"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-type">minus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312796"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312796"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312796"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-850"></span><span id="minus"><span class="annot"><span class="annottext">minus :: forall era. MUtxo era -&gt; Maybe (UtxoEntry era) -&gt; MUtxo era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-var hs-var">minus</span></a></span></span><span> </span><span id="local-6989586621681310766"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681310766"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681310766"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-851"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-var">minus</span></a></span><span> </span><span id="local-6989586621681310765"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681310765"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681310764"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681310764"><span class="hs-identifier hs-var">txin</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681310764"><span class="hs-identifier hs-var">txin</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621681310765"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier hs-type">genAlonzoTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312794"><span class="annot"><a href="#local-6989586621681312794"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312794"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312794"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312794"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312794"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312794"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span id="genAlonzoTx"><span class="annot"><span class="annottext">genAlonzoTx :: forall era.
Reflect era =&gt;
Proof era -&gt; SlotNo -&gt; GenRS era (UTxO era, Tx era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier hs-var hs-var">genAlonzoTx</span></a></span></span><span> </span><span id="local-6989586621681310756"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310756"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681310755"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310755"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-855"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681310754"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621681310754"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310753"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621681310753"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310752"><span class="annot"><span class="annottext">(TxIn (EraCrypto era), TxOut era)
</span><a href="#local-6989586621681310752"><span class="hs-identifier hs-var">_fee</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310751"><span class="annot"><span class="annottext">Maybe (TxIn (EraCrypto era), TxOut era)
</span><a href="#local-6989586621681310751"><span class="hs-identifier hs-var">_old</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; SlotNo
-&gt; GenRS
     era (UTxO era, Tx era, UtxoEntry era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTxAndInfo"><span class="hs-identifier hs-var">genAlonzoTxAndInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310756"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310755"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-856"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621681310754"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621681310753"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTxAndInfo"><span class="hs-identifier hs-type">genAlonzoTxAndInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-859"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312791"><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-860"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-861"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-862"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-863"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span>
</span><span id="line-864"></span><span>    </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-865"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-866"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-867"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-comment">-- The fee key</span><span>
</span><span id="line-868"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- from oldUtxO</span><span>
</span><span id="line-869"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span id="genAlonzoTxAndInfo"><span class="annot"><span class="annottext">genAlonzoTxAndInfo :: forall era.
Reflect era =&gt;
Proof era
-&gt; SlotNo
-&gt; GenRS
     era (UTxO era, Tx era, UtxoEntry era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTxAndInfo"><span class="hs-identifier hs-var hs-var">genAlonzoTxAndInfo</span></a></span></span><span> </span><span id="local-6989586621681310535"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681310534"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310534"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-871"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621681310533"><span class="annot"><span class="annottext">PParams era
gePParams :: PParams era
gePParams :: forall era. GenEnv era -&gt; PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span id="local-6989586621681310532"><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621681310532"><span class="hs-identifier hs-var">validityInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Gen ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier hs-var">genValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310534"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-873"></span><span>  </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681310531"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621681310531"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621681310531"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">gsValidityInterval :: ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621681310532"><span class="hs-identifier hs-var">validityInterval</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span>  </span><span class="hs-comment">-- 1. Produce utxos that will be spent</span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681310529"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310529"><span class="hs-identifier hs-var">utxoChoices</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310528"><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621681310528"><span class="hs-identifier hs-var">maybeoldpair</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
GenRS era (MUtxo era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier hs-var">genUTxO</span></a></span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span>  </span><span class="hs-comment">-- 2. Generate UTxO for spending and reference inputs</span><span>
</span><span id="line-879"></span><span>  </span><span class="hs-comment">--    Note the spending inputs and the reference inputs may overlap.</span><span>
</span><span id="line-880"></span><span>  </span><span class="hs-comment">--    feeKey is one of the inputs from the spending inputs, safe to pay the fee with.</span><span>
</span><span id="line-881"></span><span>  </span><span class="hs-special">(</span><span> </span><span id="local-6989586621681310527"><span class="annot"><span class="annottext">feepair :: UtxoEntry era
</span><a href="#local-6989586621681310527"><span class="hs-identifier hs-var">feepair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621681310526"><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681310526"><span class="hs-identifier hs-var">feeKey</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- One of the spending inputs, to be used to pay the fee</span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310525"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310525"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span></span><span> </span><span class="hs-comment">-- All of the spending inputs</span><span>
</span><span id="line-883"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310524"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310524"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span></span><span> </span><span class="hs-comment">-- All the reference inputs</span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310523"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310523"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span></span><span> </span><span class="hs-comment">-- Union of all the above</span><span>
</span><span id="line-885"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><span class="annottext">forall era.
Map (TxIn (EraCrypto era)) (TxOut era)
-&gt; GenRS
     era
     (UtxoEntry era, Map (TxIn (EraCrypto era)) (TxOut era),
      Map (TxIn (EraCrypto era)) (TxOut era),
      Map (TxIn (EraCrypto era)) (TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genSpendReferenceInputs"><span class="hs-identifier hs-var">genSpendReferenceInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310529"><span class="hs-identifier hs-var">utxoChoices</span></a></span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span>  </span><span class="hs-comment">-- 3. Check if all Plutus scripts are valid</span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681310522"><span class="hs-identifier hs-type">toSpendNoCollateralTxOuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-890"></span><span>      </span><span id="local-6989586621681310522"><span class="annot"><span class="annottext">toSpendNoCollateralTxOuts :: [TxOut era]
</span><a href="#local-6989586621681310522"><span class="hs-identifier hs-var hs-var">toSpendNoCollateralTxOuts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310525"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span>
</span><span id="line-891"></span><span>      </span><span class="hs-comment">-- We use maxBound to ensure the serialized size overestimation</span><span>
</span><span id="line-892"></span><span>      </span><span id="local-6989586621681310517"><span class="annot"><span class="annottext">maxCoin :: Coin
</span><a href="#local-6989586621681310517"><span class="hs-identifier hs-var hs-var">maxCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-comment">-- 4. Generate all recipients and witnesses needed for spending Plutus scripts</span><span>
</span><span id="line-894"></span><span>  </span><span id="local-6989586621681310516"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310516"><span class="hs-identifier hs-var">recipients</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipientsFrom"><span class="hs-identifier hs-var">genRecipientsFrom</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310522"><span class="hs-identifier hs-var">toSpendNoCollateralTxOuts</span></a></span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span>  </span><span class="hs-comment">--  mkPaymentWits :: ExUnits -&gt; [WitnessesField era]</span><span>
</span><span id="line-897"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621681310515"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681310515"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310514"><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310514"><span class="hs-identifier hs-var">mkPaymentWits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-898"></span><span>    </span><span class="annot"><span class="annottext">forall era (k :: KeyRole).
Era era =&gt;
Tag
-&gt; [Maybe (GenRS era (Data era), Credential k (EraCrypto era))]
-&gt; GenRS era (IsValid, [ExUnits -&gt; [WitnessesField era]])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var">redeemerWitnessMaker</span></a></span><span>
</span><span id="line-899"></span><span>      </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span>
</span><span id="line-900"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681310513"><span class="annot"><span class="annottext">DataHash (EraCrypto era)
</span><a href="#local-6989586621681310513"><span class="hs-identifier hs-var">dh</span></a></span></span><span> </span><span id="local-6989586621681310512"><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681310512"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
String -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">DataHash (EraCrypto era)
</span><a href="#local-6989586621681310513"><span class="hs-identifier hs-var">dh</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681310512"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DataHash (EraCrypto era))
</span><a href="#local-6989586621681310511"><span class="hs-identifier hs-var">mDatumHash</span></a></span><span>
</span><span id="line-902"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681310510"><span class="hs-identifier hs-var">credential</span></a></span><span>
</span><span id="line-903"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310509"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310509"><span class="hs-identifier hs-var">coretxout</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310525"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span>
</span><span id="line-904"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681310507"><span class="annot"><span class="annottext">[Credential 'Payment (EraCrypto era)]
</span><a href="#local-6989586621681310507"><span class="hs-identifier hs-var">credentials</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310511"><span class="annot"><span class="annottext">Maybe (DataHash (EraCrypto era))
</span><a href="#local-6989586621681310511"><span class="hs-identifier hs-var">mDatumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; TxOut era
-&gt; ([Credential 'Payment (EraCrypto era)],
    Maybe (DataHash (EraCrypto era)))
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutEvidence"><span class="hs-identifier hs-var">txoutEvidence</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310509"><span class="hs-identifier hs-var">coretxout</span></a></span><span>
</span><span id="line-905"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310510"><span class="annot"><span class="annottext">Credential 'Payment (EraCrypto era)
</span><a href="#local-6989586621681310510"><span class="hs-identifier hs-var">credential</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Credential 'Payment (EraCrypto era)]
</span><a href="#local-6989586621681310507"><span class="hs-identifier hs-var">credentials</span></a></span><span>
</span><span id="line-906"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-907"></span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-comment">-- generate Withdrawals before TxCerts, as Rewards are populated in the Model here,</span><span>
</span><span id="line-909"></span><span>  </span><span class="hs-comment">-- and we need to avoid certain TxCerts if they conflict with existing Rewards</span><span>
</span><span id="line-910"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681310505"><span class="annot"><span class="annottext">withdrawals :: Withdrawals (EraCrypto era)
</span><a href="#local-6989586621681310505"><span class="hs-identifier hs-var">withdrawals</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Withdrawals</span></a></span><span> </span><span id="local-6989586621681310504"><span class="annot"><span class="annottext">Map (RewardAcnt (EraCrypto era)) Coin
</span><a href="#local-6989586621681310504"><span class="hs-identifier hs-var">wdrlMap</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310503"><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310503"><span class="hs-identifier hs-var">newRewards</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
SlotNo
-&gt; GenRS
     era (Withdrawals (EraCrypto era), RewardAccounts (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genWithdrawals"><span class="hs-identifier hs-var">genWithdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310534"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-911"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310502"><span class="annot"><span class="annottext">withdrawalAmount :: Coin
</span><a href="#local-6989586621681310502"><span class="hs-identifier hs-var hs-var">withdrawalAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">F.fold</span></a></span><span> </span><span class="annot"><span class="annottext">Map (RewardAcnt (EraCrypto era)) Coin
</span><a href="#local-6989586621681310504"><span class="hs-identifier hs-var">wdrlMap</span></a></span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span>  </span><span id="local-6989586621681310501"><span class="annot"><span class="annottext">Maybe (TxOut era)
</span><a href="#local-6989586621681310501"><span class="hs-identifier hs-var">rewardsWithdrawalTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-914"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310502"><span class="hs-identifier hs-var">withdrawalAmount</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-915"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-916"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Value era -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310502"><span class="hs-identifier hs-var">withdrawalAmount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310500"><span class="annot"><span class="annottext">wdrlCreds :: [Credential 'Staking (EraCrypto era)]
</span><a href="#local-6989586621681310500"><span class="hs-identifier hs-var hs-var">wdrlCreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. RewardAcnt c -&gt; Credential 'Staking c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">getRwdCred</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map (RewardAcnt (EraCrypto era)) Coin
</span><a href="#local-6989586621681310504"><span class="hs-identifier hs-var">wdrlMap</span></a></span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621681310498"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681310498"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310497"><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310497"><span class="hs-identifier hs-var">mkWithdrawalsWits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-919"></span><span>    </span><span class="annot"><span class="annottext">forall era (k :: KeyRole).
Era era =&gt;
Tag
-&gt; [Maybe (GenRS era (Data era), Credential k (EraCrypto era))]
-&gt; GenRS era (IsValid, [ExUnits -&gt; [WitnessesField era]])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var">redeemerWitnessMaker</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Rewrd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; GenRS era (Data era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-var">genDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking (EraCrypto era)]
</span><a href="#local-6989586621681310500"><span class="hs-identifier hs-var">wdrlCreds</span></a></span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span>  </span><span id="local-6989586621681310495"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; SlotNo -&gt; GenRS era [TxCert era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCerts"><span class="hs-identifier hs-var">genTxCerts</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621681310534"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310494"><span class="annot"><span class="annottext">dcertCreds :: [Maybe (Credential 'Staking (EraCrypto era))]
</span><a href="#local-6989586621681310494"><span class="hs-identifier hs-var hs-var">dcertCreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
TxCert era -&gt; Maybe (Credential 'Staking (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getTxCertCredential"><span class="hs-identifier hs-var">getTxCertCredential</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span>
</span><span id="line-923"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621681310493"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681310493"><span class="hs-identifier hs-var">v3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310492"><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310492"><span class="hs-identifier hs-var">mkCertsWits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-924"></span><span>    </span><span class="annot"><span class="annottext">forall era (k :: KeyRole).
Era era =&gt;
Tag
-&gt; [Maybe (GenRS era (Data era), Credential k (EraCrypto era))]
-&gt; GenRS era (IsValid, [ExUnits -&gt; [WitnessesField era]])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var">redeemerWitnessMaker</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; GenRS era (Data era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-var">genDatum</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe (Credential 'Staking (EraCrypto era))]
</span><a href="#local-6989586621681310494"><span class="hs-identifier hs-var">dcertCreds</span></a></span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310491"><span class="annot"><span class="annottext">isValid :: IsValid
</span><a href="#local-6989586621681310491"><span class="hs-identifier hs-var hs-var">isValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IsValid
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681310515"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681310498"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681310493"><span class="hs-identifier hs-var">v3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>      </span><span class="annot"><a href="#local-6989586621681310489"><span class="hs-identifier hs-type">mkWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">ExUnits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-928"></span><span>      </span><span id="local-6989586621681310489"><span class="annot"><span class="annottext">mkWits :: [ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310489"><span class="hs-identifier hs-var hs-var">mkWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310514"><span class="hs-identifier hs-var">mkPaymentWits</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310492"><span class="hs-identifier hs-var">mkCertsWits</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310497"><span class="hs-identifier hs-var">mkWithdrawalsWits</span></a></span><span>
</span><span id="line-929"></span><span>  </span><span id="local-6989586621681310488"><span class="annot"><span class="annottext">[ExUnits]
</span><a href="#local-6989586621681310488"><span class="hs-identifier hs-var">exUnits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Int -&gt; GenRS era [ExUnits]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genExUnits"><span class="hs-identifier hs-var">genExUnits</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310489"><span class="hs-identifier hs-var">mkWits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681310487"><span class="hs-identifier hs-type">redeemerWitsList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-932"></span><span>      </span><span id="local-6989586621681310487"><span class="annot"><span class="annottext">redeemerWitsList :: [WitnessesField era]
</span><a href="#local-6989586621681310487"><span class="hs-identifier hs-var hs-var">redeemerWitsList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">($)</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310489"><span class="hs-identifier hs-var">mkWits</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits]
</span><a href="#local-6989586621681310488"><span class="hs-identifier hs-var">exUnits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>  </span><span id="local-6989586621681310485"><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310485"><span class="hs-identifier hs-var">datumWitsList</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Proof era -&gt; TxOut era -&gt; GenRS era [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#makeDatumWitness"><span class="hs-identifier hs-var">makeDatumWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310525"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>  </span><span id="local-6989586621681310484"><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310484"><span class="hs-identifier hs-var">keyWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-935"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span>
</span><span id="line-936"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; TxOut era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var">genTxOutKeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Spend</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310522"><span class="hs-identifier hs-var">toSpendNoCollateralTxOuts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310524"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-938"></span><span>  </span><span id="local-6989586621681310483"><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310483"><span class="hs-identifier hs-var">dcertWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCredKeyWit"><span class="hs-identifier hs-var">genCredKeyWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Cert</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (Credential 'Staking (EraCrypto era))]
</span><a href="#local-6989586621681310494"><span class="hs-identifier hs-var">dcertCreds</span></a></span><span>
</span><span id="line-939"></span><span>  </span><span id="local-6989586621681310482"><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310482"><span class="hs-identifier hs-var">rwdrsWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era (kr :: KeyRole).
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; Credential kr (EraCrypto era)
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCredKeyWit"><span class="hs-identifier hs-var">genCredKeyWit</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Rewrd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking (EraCrypto era)]
</span><a href="#local-6989586621681310500"><span class="hs-identifier hs-var">wdrlCreds</span></a></span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>  </span><span class="hs-comment">-- 5. Estimate inputs that will be used as collateral</span><span>
</span><span id="line-942"></span><span>  </span><span id="local-6989586621681310481"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310481"><span class="hs-identifier hs-var">maxCollateralCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-943"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><span class="hs-identifier hs-var">chooseInt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; PParams era -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#maxCollateralInputs%27"><span class="hs-identifier hs-var">maxCollateralInputs'</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>  </span><span id="local-6989586621681310479"><span class="annot"><span class="annottext">TxId (EraCrypto era)
</span><a href="#local-6989586621681310479"><span class="hs-identifier hs-var">bogusCollateralTxId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-945"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310478"><span class="annot"><span class="annottext">bogusCollateralTxIns :: Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621681310478"><span class="hs-identifier hs-var hs-var">bogusCollateralTxIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-946"></span><span>        </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span>
</span><span id="line-947"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall c. TxId c -&gt; TxIx -&gt; TxIn c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">TxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxId (EraCrypto era)
</span><a href="#local-6989586621681310479"><span class="hs-identifier hs-var">bogusCollateralTxId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Integer -&gt; TxIx
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">mkTxIxPartial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681310476"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681310476"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681310476"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310481"><span class="hs-identifier hs-var">maxCollateralCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-949"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-950"></span><span>  </span><span id="local-6989586621681310475"><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681310475"><span class="hs-identifier hs-var">collateralAddresses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310481"><span class="hs-identifier hs-var">maxCollateralCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; GenRS era (Addr (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genNoScriptRecipient"><span class="hs-identifier hs-var">genNoScriptRecipient</span></a></span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621681310474"><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310474"><span class="hs-identifier hs-var">bogusCollateralKeyWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681310475"><span class="hs-identifier hs-var">collateralAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681310473"><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681310473"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-952"></span><span>    </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; TxOut era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var">genTxOutKeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall era. Addr (EraCrypto era) -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (EraCrypto era)
</span><a href="#local-6989586621681310473"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Value era -&gt; TxOutField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Amount"><span class="hs-identifier hs-var">Amount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310517"><span class="hs-identifier hs-var">maxCoin</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>  </span><span id="local-6989586621681310472"><span class="annot"><span class="annottext">StrictMaybe Network
</span><a href="#local-6989586621681310472"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Testnet</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span>  </span><span class="hs-comment">-- 6. Generate bogus collateral fields, and functions for updating them when we know their real values</span><span>
</span><span id="line-956"></span><span>  </span><span class="hs-comment">-- Add a stub for the TotalCol field</span><span>
</span><span id="line-957"></span><span>  </span><span id="local-6989586621681310471"><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="#local-6989586621681310471"><span class="hs-identifier hs-var">bogusTotalCol</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- generate a bogus Coin, fill it in later</span><span>
</span><span id="line-958"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310469"><span class="annot"><span class="annottext">updateTotalColl :: StrictMaybe Coin -&gt; Coin -&gt; StrictMaybe Coin
</span><a href="#local-6989586621681310469"><span class="hs-identifier hs-var hs-var">updateTotalColl</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><span class="hs-identifier hs-var">SNothing</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-959"></span><span>      </span><span class="annot"><a href="#local-6989586621681310469"><span class="hs-identifier hs-var">updateTotalColl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621681310468"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681310468"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621681310467"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681310467"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681310468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681310467"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-960"></span><span>  </span><span class="hs-comment">-- If Babbage era, or greater, add a stub for a CollateralReturn TxOut</span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621681310466"><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621681310466"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-962"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (i :: k). Singleton t =&gt; t i -&gt; Some t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (i :: k). Singleton t =&gt; t i -&gt; Some t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (BabbageEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-964"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-965"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Proof era -&gt; [TxOutField era] -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxOut"><span class="hs-identifier hs-var">coreTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era -&gt; Value era -&gt; GenRS era [TxOutField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. Val t =&gt; Coin -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-968"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310463"><span class="annot"><span class="annottext">updateCollReturn :: StrictMaybe (TxOut era) -&gt; Coin -&gt; StrictMaybe (TxOut era)
</span><a href="#local-6989586621681310463"><span class="hs-identifier hs-var hs-var">updateCollReturn</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><span class="hs-identifier hs-var">SNothing</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-970"></span><span>      </span><span class="annot"><a href="#local-6989586621681310463"><span class="hs-identifier hs-var">updateCollReturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span id="local-6989586621681310462"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310462"><span class="hs-identifier hs-var">txout</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681310461"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310461"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
Proof era -&gt; Coin -&gt; TxOut era -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#injectFee"><span class="hs-identifier hs-var">injectFee</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310461"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621681310462"><span class="hs-identifier hs-var">txout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-comment">-- 7. Estimate the fee</span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310459"><span class="annot"><span class="annottext">redeemerDatumWits :: [WitnessesField era]
</span><a href="#local-6989586621681310459"><span class="hs-identifier hs-var hs-var">redeemerDatumWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310487"><span class="hs-identifier hs-var">redeemerWitsList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310485"><span class="hs-identifier hs-var">datumWitsList</span></a></span><span>
</span><span id="line-974"></span><span>      </span><span id="local-6989586621681310458"><span class="annot"><span class="annottext">bogusIntegrityHash :: StrictMaybe (ScriptIntegrityHash (EraCrypto era))
</span><a href="#local-6989586621681310458"><span class="hs-identifier hs-var hs-var">bogusIntegrityHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; PParams era
-&gt; [Language]
-&gt; Redeemers era
-&gt; TxDats era
-&gt; StrictMaybe (ScriptIntegrityHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#newScriptIntegrityHash"><span class="hs-identifier hs-var">newScriptIntegrityHash</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits) -&gt; Redeemers era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-975"></span><span>      </span><span id="local-6989586621681310456"><span class="annot"><span class="annottext">inputSet :: Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621681310456"><span class="hs-identifier hs-var hs-var">inputSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310525"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span>
</span><span id="line-976"></span><span>      </span><span id="local-6989586621681310455"><span class="annot"><span class="annottext">outputList :: [TxOut era]
</span><a href="#local-6989586621681310455"><span class="hs-identifier hs-var hs-var">outputList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310516"><span class="hs-identifier hs-var">recipients</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310516"><span class="hs-identifier hs-var">recipients</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut era)
</span><a href="#local-6989586621681310501"><span class="hs-identifier hs-var">rewardsWithdrawalTxOut</span></a></span><span>
</span><span id="line-977"></span><span>      </span><span id="local-6989586621681310454"><span class="annot"><span class="annottext">txBodyNoFee :: TxBody era
</span><a href="#local-6989586621681310454"><span class="hs-identifier hs-var hs-var">txBodyNoFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-978"></span><span>        </span><span class="annot"><span class="annottext">forall era.
EraTxBody era =&gt;
Proof era -&gt; [TxBodyField era] -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTxBody"><span class="hs-identifier hs-var">coreTxBody</span></a></span><span>
</span><span id="line-979"></span><span>          </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-980"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. Set (TxIn (EraCrypto era)) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Inputs"><span class="hs-identifier hs-var">Inputs</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621681310456"><span class="hs-identifier hs-var">inputSet</span></a></span><span>
</span><span id="line-981"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (TxIn (EraCrypto era)) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Collateral"><span class="hs-identifier hs-var">Collateral</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (EraCrypto era))
</span><a href="#local-6989586621681310478"><span class="hs-identifier hs-var">bogusCollateralTxIns</span></a></span><span>
</span><span id="line-982"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (TxIn (EraCrypto era)) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#RefInputs"><span class="hs-identifier hs-var">RefInputs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310524"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-983"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe Coin -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#TotalCol"><span class="hs-identifier hs-var">TotalCol</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="#local-6989586621681310471"><span class="hs-identifier hs-var">bogusTotalCol</span></a></span><span>
</span><span id="line-984"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [TxOut era] -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Outputs%27"><span class="hs-identifier hs-var">Outputs'</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621681310455"><span class="hs-identifier hs-var">outputList</span></a></span><span>
</span><span id="line-985"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe (TxOut era) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#CollateralReturn"><span class="hs-identifier hs-var">CollateralReturn</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621681310466"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span><span>
</span><span id="line-986"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [TxCert era] -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Certs%27"><span class="hs-identifier hs-var">Certs'</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span>
</span><span id="line-987"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Withdrawals (EraCrypto era) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Withdrawals%27"><span class="hs-identifier hs-var">Withdrawals'</span></a></span><span> </span><span class="annot"><span class="annottext">Withdrawals (EraCrypto era)
</span><a href="#local-6989586621681310505"><span class="hs-identifier hs-var">withdrawals</span></a></span><span>
</span><span id="line-988"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Coin -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Txfee"><span class="hs-identifier hs-var">Txfee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310517"><span class="hs-identifier hs-var">maxCoin</span></a></span><span>
</span><span id="line-989"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (i :: k). Singleton t =&gt; t i -&gt; Some t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (i :: k). Singleton t =&gt; t i -&gt; Some t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-data-1.1.0.0/doc/html/cardano-data/src"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. Crypto c =&gt; Evidence c -&gt; Proof (AllegraEra c)
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence Mock
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mock"><span class="hs-identifier hs-var">Mock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-990"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall era. ValidityInterval -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Vldt"><span class="hs-identifier hs-var">Vldt</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621681310532"><span class="hs-identifier hs-var">validityInterval</span></a></span><span>
</span><span id="line-991"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall era. SlotNo -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#TTL"><span class="hs-identifier hs-var">TTL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidityInterval -&gt; SlotNo
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#timeToLive"><span class="hs-identifier hs-var">timeToLive</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621681310532"><span class="hs-identifier hs-var">validityInterval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-992"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [Update era] -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Update%27"><span class="hs-identifier hs-var">Update'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-993"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [KeyHash 'Witness (EraCrypto era)] -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#ReqSignerHashes%27"><span class="hs-identifier hs-var">ReqSignerHashes'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-994"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. MultiAsset (EraCrypto era) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Mint"><span class="hs-identifier hs-var">Generic.Mint</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-995"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
StrictMaybe (ScriptIntegrityHash (EraCrypto era))
-&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#WppHash"><span class="hs-identifier hs-var">WppHash</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (ScriptIntegrityHash (EraCrypto era))
</span><a href="#local-6989586621681310458"><span class="hs-identifier hs-var">bogusIntegrityHash</span></a></span><span>
</span><span id="line-996"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [AuxiliaryDataHash (EraCrypto era)] -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#AdHash%27"><span class="hs-identifier hs-var">AdHash'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-997"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe Network -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Txnetworkid"><span class="hs-identifier hs-var">Txnetworkid</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Network
</span><a href="#local-6989586621681310472"><span class="hs-identifier hs-var">networkId</span></a></span><span>
</span><span id="line-998"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-999"></span><span>      </span><span id="local-6989586621681310437"><span class="annot"><span class="annottext">txBodyNoFeeHash :: SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681310437"><span class="hs-identifier hs-var hs-var">txBodyNoFeeHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall x index c.
(HashAnnotated x index c, HashAlgorithm (HASH c)) =&gt;
x -&gt; SafeHash c index
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashAnnotated</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310454"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-1000"></span><span>      </span><span class="annot"><a href="#local-6989586621681310436"><span class="hs-identifier hs-type">witsMakers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1001"></span><span>      </span><span id="local-6989586621681310436"><span class="annot"><span class="annottext">witsMakers :: [SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310436"><span class="hs-identifier hs-var hs-var">witsMakers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310484"><span class="hs-identifier hs-var">keyWitsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310483"><span class="hs-identifier hs-var">dcertWitsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310482"><span class="hs-identifier hs-var">rwdrsWitsMakers</span></a></span><span>
</span><span id="line-1002"></span><span>      </span><span id="local-6989586621681310435"><span class="annot"><span class="annottext">bogusNeededScripts :: Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310435"><span class="hs-identifier hs-var hs-var">bogusNeededScripts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; MUtxo era -&gt; TxBody era -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#scriptWitsNeeded%27"><span class="hs-identifier hs-var">scriptWitsNeeded'</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310523"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310454"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-1003"></span><span>      </span><span class="annot"><a href="#local-6989586621681310433"><span class="hs-identifier hs-type">noFeeWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312791"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1004"></span><span>      </span><span id="local-6989586621681310433"><span class="annot"><span class="annottext">noFeeWits :: [WitnessesField era]
</span><a href="#local-6989586621681310433"><span class="hs-identifier hs-var hs-var">noFeeWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1005"></span><span>        </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; Set (ScriptHash (EraCrypto era))
-&gt; [WitnessesField era]
-&gt; [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310435"><span class="hs-identifier hs-var">bogusNeededScripts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1006"></span><span>          </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310459"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span>
</span><span id="line-1007"></span><span>            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681310437"><span class="hs-identifier hs-var">txBodyNoFeeHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310436"><span class="hs-identifier hs-var">witsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310474"><span class="hs-identifier hs-var">bogusCollateralKeyWitsMakers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1008"></span><span>      </span><span id="local-6989586621681310431"><span class="annot"><span class="annottext">bogusTxForFeeCalc :: Tx era
</span><a href="#local-6989586621681310431"><span class="hs-identifier hs-var hs-var">bogusTxForFeeCalc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1009"></span><span>        </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; [TxField era] -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTx"><span class="hs-identifier hs-var">coreTx</span></a></span><span>
</span><span id="line-1010"></span><span>          </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-1011"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. TxBody era -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Body"><span class="hs-identifier hs-var">Body</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310454"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-1012"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. TxWits era -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#TxWits"><span class="hs-identifier hs-var">TxWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Proof era -&gt; [WitnessesField era] -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#assembleWits"><span class="hs-identifier hs-var">assembleWits</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310433"><span class="hs-identifier hs-var">noFeeWits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. IsValid -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Valid"><span class="hs-identifier hs-var">Valid</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621681310491"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-1014"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [TxAuxData era] -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#AuxData%27"><span class="hs-identifier hs-var">AuxData'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1015"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1016"></span><span>      </span><span id="local-6989586621681310426"><span class="annot"><span class="annottext">fee :: Coin
</span><a href="#local-6989586621681310426"><span class="hs-identifier hs-var hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraTx era =&gt; PParams era -&gt; Tx era -&gt; Coin
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">getMinFeeTx</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621681310431"><span class="hs-identifier hs-var">bogusTxForFeeCalc</span></a></span><span>
</span><span id="line-1017"></span><span>
</span><span id="line-1018"></span><span>  </span><span id="local-6989586621681310424"><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ModelNewEpochState era
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mKeyDeposits"><span class="hs-identifier hs-var">mKeyDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310422"><span class="annot"><span class="annottext">deposits :: Coin
</span><a href="#local-6989586621681310422"><span class="hs-identifier hs-var hs-var">deposits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1020"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era
-&gt; [TxCert era]
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span><span>
</span><span id="line-1021"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era
-&gt; [TxCert era]
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span><span>
</span><span id="line-1022"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era
-&gt; [TxCert era]
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span><span>
</span><span id="line-1023"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era
-&gt; [TxCert era]
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span><span>
</span><span id="line-1024"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era
-&gt; [TxCert era]
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span><span>
</span><span id="line-1025"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
(EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era
-&gt; [TxCert era]
-&gt; Map (Credential 'Staking (EraCrypto era)) Coin
-&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621681310495"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310424"><span class="hs-identifier hs-var">keyDeposits</span></a></span><span>
</span><span id="line-1026"></span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-comment">-- 8. Crank up the amount in one of outputs to account for the fee and deposits. Note</span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-comment">-- this is a hack that is not possible in a real life, but in the end it does produce</span><span>
</span><span id="line-1029"></span><span>  </span><span class="hs-comment">-- real life like setup. We use the entry with TxIn feeKey, which we can safely overwrite.</span><span>
</span><span id="line-1030"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310384"><span class="annot"><span class="annottext">utxoFeeAdjusted :: Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310384"><span class="hs-identifier hs-var hs-var">utxoFeeAdjusted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
Proof era -&gt; Coin -&gt; TxOut era -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#injectFee"><span class="hs-identifier hs-var">injectFee</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310426"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310422"><span class="hs-identifier hs-var">deposits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxIn (EraCrypto era)
</span><a href="#local-6989586621681310526"><span class="hs-identifier hs-var">feeKey</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310523"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-comment">-- 9. Generate utxos that will be used as collateral</span><span>
</span><span id="line-1033"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681310382"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310381"><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310381"><span class="hs-identifier hs-var">collMap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310380"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310380"><span class="hs-identifier hs-var">excessColCoin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasCallStack, Reflect era) =&gt;
[Addr (EraCrypto era)]
-&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCollateralUTxO"><span class="hs-identifier hs-var">genCollateralUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr (EraCrypto era)]
</span><a href="#local-6989586621681310475"><span class="hs-identifier hs-var">collateralAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310426"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310384"><span class="hs-identifier hs-var">utxoFeeAdjusted</span></a></span><span>
</span><span id="line-1034"></span><span>  </span><span id="local-6989586621681310379"><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310379"><span class="hs-identifier hs-var">collateralKeyWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1035"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
Proof era
-&gt; Maybe Tag
-&gt; TxOut era
-&gt; GenRS
     era
     (SafeHash (EraCrypto era) EraIndependentTxBody
      -&gt; [WitnessesField era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var">genTxOutKeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310381"><span class="hs-identifier hs-var">collMap</span></a></span><span>
</span><span id="line-1036"></span><span>
</span><span id="line-1037"></span><span>  </span><span class="hs-comment">-- 10. Construct the correct Tx with valid fee and collaterals</span><span>
</span><span id="line-1038"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681310378"><span class="annot"><span class="annottext">sNeeded :: Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310378"><span class="hs-identifier hs-var hs-var">sNeeded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; MUtxo era -&gt; TxBody era -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#scriptsNeeded%27"><span class="hs-identifier hs-var">scriptsNeeded'</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310454"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-1039"></span><span>      </span><span id="local-6989586621681310376"><span class="annot"><span class="annottext">langs :: [Language]
</span><a href="#local-6989586621681310376"><span class="hs-identifier hs-var hs-var">langs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Proof era
-&gt; Tx era
-&gt; UTxO era
-&gt; Set (ScriptHash (EraCrypto era))
-&gt; Set Language
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#languagesUsed"><span class="hs-identifier hs-var">languagesUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621681310431"><span class="hs-identifier hs-var">bogusTxForFeeCalc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310523"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310378"><span class="hs-identifier hs-var">sNeeded</span></a></span><span>
</span><span id="line-1040"></span><span>      </span><span id="local-6989586621681310372"><span class="annot"><span class="annottext">mIntegrityHash :: StrictMaybe (ScriptIntegrityHash (EraCrypto era))
</span><a href="#local-6989586621681310372"><span class="hs-identifier hs-var hs-var">mIntegrityHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1041"></span><span>        </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; PParams era
-&gt; [Language]
-&gt; Redeemers era
-&gt; TxDats era
-&gt; StrictMaybe (ScriptIntegrityHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Updaters.html#newScriptIntegrityHash"><span class="hs-identifier hs-var">newScriptIntegrityHash</span></a></span><span>
</span><span id="line-1042"></span><span>          </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-1043"></span><span>          </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621681310533"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-1044"></span><span>          </span><span class="annot"><span class="annottext">[Language]
</span><a href="#local-6989586621681310376"><span class="hs-identifier hs-var">langs</span></a></span><span>
</span><span id="line-1045"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; [WitnessesField era] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTxrdmrs"><span class="hs-identifier hs-var">mkTxrdmrs</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310459"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; [WitnessesField era] -&gt; TxDats era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTxdats"><span class="hs-identifier hs-var">mkTxdats</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310459"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span>      </span><span id="local-6989586621681310369"><span class="annot"><span class="annottext">balance :: Coin
</span><a href="#local-6989586621681310369"><span class="hs-identifier hs-var hs-var">balance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1048"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621681310466"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1049"></span><span>          </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><span class="hs-identifier hs-var">SNothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
Set (TxIn (EraCrypto era)) -&gt; MUtxo era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txInBalance"><span class="hs-identifier hs-var">txInBalance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310381"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-1050"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era.
EraTxOut era =&gt;
Set (TxIn (EraCrypto era)) -&gt; MUtxo era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txInBalance"><span class="hs-identifier hs-var">txInBalance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310381"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310380"><span class="hs-identifier hs-var">excessColCoin</span></a></span><span>
</span><span id="line-1051"></span><span>      </span><span id="local-6989586621681310367"><span class="annot"><span class="annottext">txBody :: TxBody era
</span><a href="#local-6989586621681310367"><span class="hs-identifier hs-var hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1052"></span><span>        </span><span class="annot"><span class="annottext">forall era.
EraTxBody era =&gt;
Proof era -&gt; TxBody era -&gt; [TxBodyField era] -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#overrideTxBody"><span class="hs-identifier hs-var">overrideTxBody</span></a></span><span>
</span><span id="line-1053"></span><span>          </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-1054"></span><span>          </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310454"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-1055"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. Coin -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Txfee"><span class="hs-identifier hs-var">Txfee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310426"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-1056"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. Set (TxIn (EraCrypto era)) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Collateral"><span class="hs-identifier hs-var">Collateral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310381"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe (TxOut era) -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#CollateralReturn"><span class="hs-identifier hs-var">CollateralReturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe (TxOut era) -&gt; Coin -&gt; StrictMaybe (TxOut era)
</span><a href="#local-6989586621681310463"><span class="hs-identifier hs-var">updateCollReturn</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621681310466"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310380"><span class="hs-identifier hs-var">excessColCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. StrictMaybe Coin -&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#TotalCol"><span class="hs-identifier hs-var">TotalCol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe Coin -&gt; Coin -&gt; StrictMaybe Coin
</span><a href="#local-6989586621681310469"><span class="hs-identifier hs-var">updateTotalColl</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="#local-6989586621681310471"><span class="hs-identifier hs-var">bogusTotalCol</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621681310369"><span class="hs-identifier hs-var">balance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
StrictMaybe (ScriptIntegrityHash (EraCrypto era))
-&gt; TxBodyField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#WppHash"><span class="hs-identifier hs-var">WppHash</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (ScriptIntegrityHash (EraCrypto era))
</span><a href="#local-6989586621681310372"><span class="hs-identifier hs-var">mIntegrityHash</span></a></span><span>
</span><span id="line-1060"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1061"></span><span>      </span><span id="local-6989586621681310366"><span class="annot"><span class="annottext">txBodyHash :: SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681310366"><span class="hs-identifier hs-var hs-var">txBodyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall x index c.
(HashAnnotated x index c, HashAlgorithm (HASH c)) =&gt;
x -&gt; SafeHash c index
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">hashAnnotated</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310367"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-1062"></span><span>      </span><span id="local-6989586621681310365"><span class="annot"><span class="annottext">neededScripts :: Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310365"><span class="hs-identifier hs-var hs-var">neededScripts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; MUtxo era -&gt; TxBody era -&gt; Set (ScriptHash (EraCrypto era))
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#scriptWitsNeeded%27"><span class="hs-identifier hs-var">scriptWitsNeeded'</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310367"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-1063"></span><span>      </span><span id="local-6989586621681310364"><span class="annot"><span class="annottext">wits :: [WitnessesField era]
</span><a href="#local-6989586621681310364"><span class="hs-identifier hs-var hs-var">wits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1064"></span><span>        </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; Set (ScriptHash (EraCrypto era))
-&gt; [WitnessesField era]
-&gt; [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310365"><span class="hs-identifier hs-var">neededScripts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1065"></span><span>          </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310459"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span>
</span><span id="line-1066"></span><span>            </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681310366"><span class="hs-identifier hs-var">txBodyHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310436"><span class="hs-identifier hs-var">witsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash (EraCrypto era) EraIndependentTxBody
 -&gt; [WitnessesField era]]
</span><a href="#local-6989586621681310379"><span class="hs-identifier hs-var">collateralKeyWitsMakers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span>      </span><span id="local-6989586621681310363"><span class="annot"><span class="annottext">validTx :: Tx era
</span><a href="#local-6989586621681310363"><span class="hs-identifier hs-var hs-var">validTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1068"></span><span>        </span><span class="annot"><span class="annottext">forall era. Proof era -&gt; [TxField era] -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#coreTx"><span class="hs-identifier hs-var">coreTx</span></a></span><span>
</span><span id="line-1069"></span><span>          </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span>
</span><span id="line-1070"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. TxBody era -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Body"><span class="hs-identifier hs-var">Body</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621681310367"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-1071"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. TxWits era -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#TxWits"><span class="hs-identifier hs-var">TxWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Proof era -&gt; [WitnessesField era] -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#assembleWits"><span class="hs-identifier hs-var">assembleWits</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310535"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310364"><span class="hs-identifier hs-var">wits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. IsValid -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#Valid"><span class="hs-identifier hs-var">Valid</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621681310491"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-1073"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era. [TxAuxData era] -&gt; TxField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#AuxData%27"><span class="hs-identifier hs-var">AuxData'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1074"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1075"></span><span>  </span><span id="local-6989586621681310362"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310362"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. ModelNewEpochState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mCount"><span class="hs-identifier hs-var">mCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (Credential 'Staking (EraCrypto era)) Coin
 -&gt; Map (Credential 'Staking (EraCrypto era)) Coin)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialRewards"><span class="hs-identifier hs-var">modifyGenStateInitialRewards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.union`</span></span><span> </span><span class="annot"><span class="annottext">RewardAccounts (EraCrypto era)
</span><a href="#local-6989586621681310503"><span class="hs-identifier hs-var">newRewards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (TxIn (EraCrypto era)) (TxOut era)
 -&gt; Map (TxIn (EraCrypto era)) (TxOut era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier hs-var">modifyGenStateInitialUtxo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.union`</span></span><span> </span><span class="annot"><span class="annottext">forall era. MUtxo era -&gt; Maybe (UtxoEntry era) -&gt; MUtxo era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-var">minus</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621681310528"><span class="hs-identifier hs-var">maybeoldpair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span>  </span><span class="annot"><span class="annottext">forall era. (Int -&gt; Int) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier hs-var">modifyModelCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310362"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map Int (TxId (EraCrypto era)) -&gt; Map Int (TxId (EraCrypto era)))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier hs-var">modifyModelIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681310362"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. SafeHash c EraIndependentTxBody -&gt; TxId c
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">TxId</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash (EraCrypto era) EraIndependentTxBody
</span><a href="#local-6989586621681310366"><span class="hs-identifier hs-var">txBodyHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1080"></span><span>  </span><span class="annot"><span class="annottext">forall era.
(Map (TxIn (EraCrypto era)) (TxOut era)
 -&gt; Map (TxIn (EraCrypto era)) (TxOut era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier hs-var">modifyModelUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Map (TxIn (EraCrypto era)) (TxOut era) -&gt; UTxO era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Map (TxIn (EraCrypto era)) (TxOut era)
</span><a href="#local-6989586621681310382"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621681310363"><span class="hs-identifier hs-var">validTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoEntry era
</span><a href="#local-6989586621681310527"><span class="hs-identifier hs-var">feepair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621681310528"><span class="hs-identifier hs-var">maybeoldpair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span class="hs-comment">-- | Keep only Script witnesses that are neccessary in 'era',</span><span>
</span><span id="line-1085"></span><span id="local-6989586621681312740"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-type">onlyNecessaryScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312740"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312740"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312740"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312740"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1086"></span><span id="onlyNecessaryScripts"><span class="annot"><span class="annottext">onlyNecessaryScripts :: forall era.
Proof era
-&gt; Set (ScriptHash (EraCrypto era))
-&gt; [WitnessesField era]
-&gt; [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var hs-var">onlyNecessaryScripts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1087"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span id="local-6989586621681310358"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310358"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681310357"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310357"><span class="hs-identifier hs-var">hashes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#ScriptWits"><span class="hs-identifier hs-type">ScriptWits</span></a></span><span> </span><span id="local-6989586621681310355"><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621681310355"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681310354"><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310354"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1088"></span><span>  </span><span class="annot"><span class="annottext">forall era.
Map (ScriptHash (EraCrypto era)) (Script era) -&gt; WitnessesField era
</span><a href="Test.Cardano.Ledger.Generic.Fields.html#ScriptWits"><span class="hs-identifier hs-var">ScriptWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash (EraCrypto era)) (Script era)
</span><a href="#local-6989586621681310355"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310357"><span class="hs-identifier hs-var">hashes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; Set (ScriptHash (EraCrypto era))
-&gt; [WitnessesField era]
-&gt; [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310358"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310357"><span class="hs-identifier hs-var">hashes</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310354"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1089"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span id="local-6989586621681310353"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310353"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621681310352"><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310352"><span class="hs-identifier hs-var">hashes</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681310351"><span class="annot"><span class="annottext">WitnessesField era
</span><a href="#local-6989586621681310351"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621681310350"><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310350"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WitnessesField era
</span><a href="#local-6989586621681310351"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">forall era.
Proof era
-&gt; Set (ScriptHash (EraCrypto era))
-&gt; [WitnessesField era]
-&gt; [WitnessesField era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310353"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash (EraCrypto era))
</span><a href="#local-6989586621681310352"><span class="hs-identifier hs-var">hashes</span></a></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310350"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span class="hs-comment">-- | Scan though the fields unioning all the RdrmWits fields into one Redeemer map</span><span>
</span><span id="line-1092"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTxrdmrs"><span class="hs-identifier hs-type">mkTxrdmrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312723"><span class="annot"><a href="#local-6989586621681312723"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312723"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312723"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312723"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-1093"></span><span id="mkTxrdmrs"><span class="annot"><span class="annottext">mkTxrdmrs :: forall era. Era era =&gt; [WitnessesField era] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTxrdmrs"><span class="hs-identifier hs-var hs-var">mkTxrdmrs</span></a></span></span><span> </span><span id="local-6989586621681310345"><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310345"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits) -&gt; Redeemers era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {era}.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits)
-&gt; WitnessesField era -&gt; Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310344"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310345"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1094"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1095"></span><span>    </span><span id="local-6989586621681310344"><span class="annot"><span class="annottext">accum :: Map RdmrPtr (Data era, ExUnits)
-&gt; WitnessesField era -&gt; Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310344"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621681310340"><span class="annot"><span class="annottext">Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310340"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#RdmrWits"><span class="hs-identifier hs-type">RdmrWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span id="local-6989586621681310339"><span class="annot"><span class="annottext">Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310339"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310340"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310339"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-1096"></span><span>    </span><span class="annot"><a href="#local-6989586621681310344"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span id="local-6989586621681310338"><span class="annot"><span class="annottext">Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310338"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="annot"><span class="annottext">WitnessesField era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data era, ExUnits)
</span><a href="#local-6989586621681310338"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- | Scan though the fields unioning all the DataWits fields into one TxDat</span><span>
</span><span id="line-1099"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTxdats"><span class="hs-identifier hs-type">mkTxdats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312722"><span class="annot"><a href="#local-6989586621681312722"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312722"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#WitnessesField"><span class="hs-identifier hs-type">WitnessesField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312722"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-type">TxDats</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312722"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-1100"></span><span id="mkTxdats"><span class="annot"><span class="annottext">mkTxdats :: forall era. Era era =&gt; [WitnessesField era] -&gt; TxDats era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTxdats"><span class="hs-identifier hs-var hs-var">mkTxdats</span></a></span></span><span> </span><span id="local-6989586621681310330"><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310330"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
Era era =&gt;
Map (DataHash (EraCrypto era)) (Data era) -&gt; TxDats era
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">TxDats</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
-&gt; WitnessesField era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310328"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">[WitnessesField era]
</span><a href="#local-6989586621681310330"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1102"></span><span>    </span><span id="local-6989586621681310328"><span class="annot"><span class="annottext">accum :: Map (DataHash (EraCrypto era)) (Data era)
-&gt; WitnessesField era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310328"><span class="hs-identifier hs-var hs-var">accum</span></a></span></span><span> </span><span id="local-6989586621681310327"><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310327"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Fields.html#DataWits%27"><span class="hs-identifier hs-type">DataWits'</span></a></span><span> </span><span id="local-6989586621681310326"><span class="annot"><span class="annottext">[Data era]
</span><a href="#local-6989586621681310326"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">List.foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
-&gt; Data era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310325"><span class="hs-identifier hs-var">accum2</span></a></span><span> </span><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310327"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Data era]
</span><a href="#local-6989586621681310326"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1103"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1104"></span><span>        </span><span id="local-6989586621681310325"><span class="annot"><span class="annottext">accum2 :: Map (DataHash (EraCrypto era)) (Data era)
-&gt; Data era -&gt; Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310325"><span class="hs-identifier hs-var hs-var">accum2</span></a></span></span><span> </span><span id="local-6989586621681310324"><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310324"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span id="local-6989586621681310323"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681310323"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; Data era -&gt; DataHash (EraCrypto era)
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-alonzo-1.4.0.0/doc/html/cardano-ledger-alonzo/src"><span class="hs-identifier hs-var">hashData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681312722"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681310323"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621681310323"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310324"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-1105"></span><span>    </span><span class="annot"><a href="#local-6989586621681310328"><span class="hs-identifier hs-var">accum</span></a></span><span> </span><span id="local-6989586621681310322"><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310322"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">WitnessesField era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (DataHash (EraCrypto era)) (Data era)
</span><a href="#local-6989586621681310322"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span class="hs-comment">-- =======================================================</span><span>
</span><span id="line-1108"></span><span class="hs-comment">-- An encapsulation of the Top level types we generate,</span><span>
</span><span id="line-1109"></span><span class="hs-comment">-- but that has its own Show instance that we can control.</span><span>
</span><span id="line-1110"></span><span>
</span><span id="line-1111"></span><span class="hs-keyword">data</span><span> </span><span id="Box"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#Box"><span class="hs-identifier hs-var">Box</span></a></span></span><span> </span><span id="local-6989586621681310321"><span class="annot"><a href="#local-6989586621681310321"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Box"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#Box"><span class="hs-identifier hs-var">Box</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681310321"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681310321"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681310321"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-1114"></span><span>  </span><span id="local-6989586621681310315"><span id="local-6989586621681310318"><span id="local-6989586621681312709"><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PrettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1116"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PrettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-type">PrettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">Signal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-1119"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1120"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#Box"><span class="hs-identifier hs-type">Box</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312709"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1121"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1122"></span><span>  </span><span id="local-6989586621681310309"><span class="annot"><span class="annottext">show :: Box era -&gt; String
</span><a href="#local-6989586621681310309"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#Box"><span class="hs-identifier hs-type">Box</span></a></span><span> </span><span id="local-6989586621681310308"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621681310308"><span class="hs-identifier hs-var">_proof</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681310306"><span class="annot"><span class="annottext">Environment (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681310306"><span class="hs-identifier hs-var">_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310305"><span class="annot"><span class="annottext">State (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681310305"><span class="hs-identifier hs-var">_state</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681310304"><span class="annot"><span class="annottext">Signal (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681310304"><span class="hs-identifier hs-var">_sig</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681310303"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621681310303"><span class="hs-identifier hs-var">_gs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1123"></span><span>    </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1124"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; [(Text, PDoc)] -&gt; PDoc
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-pretty-1.3.0.0/doc/html/cardano-ledger-pretty/src"><span class="hs-identifier hs-var">ppRecord</span></a></span><span>
</span><span id="line-1125"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Box&quot;</span></span><span>
</span><span id="line-1126"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1127"></span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- ==============================================================================</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- How we take the generated stuff and put it through the STS rule mechanism</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- in a way that is Era Agnostic</span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-type">applySTSByProof</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1133"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681312702"><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1134"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#GoodCrypto"><span class="hs-identifier hs-type">GoodCrypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraCrypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1135"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1136"></span><span>  </span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">RuleContext</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1137"></span><span>  </span><span class="annot"><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-core-1.5.0.0/doc/html/cardano-ledger-core/src"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621681312702"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1138"></span><span id="applySTSByProof"><span class="annot"><span class="annottext">applySTSByProof :: forall era.
(Era era, GoodCrypto (EraCrypto era)) =&gt;
Proof era
-&gt; RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
-&gt; Either
     [PredicateFailure (EraRule &quot;LEDGER&quot; era)]
     (State (EraRule &quot;LEDGER&quot; era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-var hs-var">applySTSByProof</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681310002"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681310002"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681310002"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1139"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-var">applySTSByProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681309769"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309769"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309769"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1140"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-var">applySTSByProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681309583"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309583"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309583"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1141"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-var">applySTSByProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681309441"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309441"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309441"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1142"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-var">applySTSByProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681309306"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309306"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309306"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1143"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applySTSByProof"><span class="hs-identifier hs-var">applySTSByProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">Evidence c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681309146"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309146"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ShelleyBase a -&gt; a
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/cardano-ledger-shelley-test-1.2.0.2/doc/html/cardano-ledger-shelley-test/src"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/q054vsi5sfzqlmqglzmmfpa98y36ixhz-ghc-9.2.8-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s -&gt; m (Either [PredicateFailure s] (State s))
</span><a href="../file:///home/runner/work/cardano-ledger-specs/cardano-ledger-specs/dist-newstyle/build/x86_64-linux/ghc-9.2.8/small-steps-1.0.0.0/doc/html/small-steps/src"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621681309146"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1144"></span></pre></body></html>